---
title: "Assignment 1: Data and Descriptive"
format: pdf
editor: visual
bibliography: references.bib
author: emilie and ingrid
---

## Assignment 1: Data and Descriptive

This assignment is intended to gather, process, and analyze sub-national GDP and population data for a selection of European countries.
We will calculate GDP per capita and investigate regional disparities using various descriptive statistics and visualizations.
The data sets are taken from Eurostat.

We have been tasked with analyzing Ireland (IE), Poland (PL), Spain (ES), Slovenia (SI), the Netherlands(NL), Greece (EL), Norway (NO), Albania(AL) from the year 2000 to 2020.

When we had been working on the assignment for a while, we realized that we had downloaded a dataset for GDP.
Given that we had already performed several calculations, we decided to select the countries we no longer needed instead of reloading the dataset.
As a result, there are a few chunks that include selections to ensure the dataset was adjusted accordingly.

```{r}
#| label: setup
#| message: false
#| output: false
library(tidyverse)
library(dplyr)
library(dineq)
library(ineq)
library(magrittr)
```

## Part A : Sub-national GDP and GDP per Capita

### **1 . Data Acquisition:**

#### Dataset: GDP

This dataset is a sub-regional GDP dataset for a selection of our European countries.
GDP stands for Gross Domestic Product, and it is a key economic indicator used to measure the overall economic health and performance of a country or region @zotero-122.
The variables relevant to us are;

GEO: this variable show us the geopolitical entity.

Time_Period: this variable shows us the time period in years.

Obs_Value: this variable shows us the value of GDP.

@zotero-126

```{r}
GDP <- read_csv("GDP.csv", show_col_types = FALSE)
```

```{r}
#In order to obtain accurate GDP figures, we had to select 'MIO_EUR' as the unit, as it represents the GDP values.
NO_GDP <- GDP |> 
  filter(str_sub(geo,1,2) == "NO") |> 
  filter(unit == "MIO_EUR")
```

```{r}
dim(GDP)
```

As mentioned earlier, we initially had all the countries in a single dataset and had to perform selections accordingly.
Will therefor reduce it after getting population.

Before we start calculating the GDP per inhabitant for each sub-region, we want to "clean up" the dataset so that we only include the necessary variables:

```{r}
# We rename one of the variables and select the ones we want
GDP <- GDP |> 
  select(year = TIME_PERIOD, unit, geo, gdp = OBS_VALUE)
```

#### Dataset: Population

This dataset is a dataset about population for a selection of our European countries.
Population refers to the total number of individuals of a particular species or group inhabiting a specific area or planet at a given time.The variables relevant to us are;

GEO: this variable show us the geopolitical entity.

Time_Period: this variable shows us the time period in years.

Obs_Value: this variable shows us the value of population.

@zotero-124

```{r}
population <- read_csv("population.csv", show_col_types = FALSE)
```

We will do the same as on the previous data set by selecting the necessary variables:

```{r}
# We rename one of the variables and select the ones we want
population <- population |> 
  select(year = TIME_PERIOD, geo, population = OBS_VALUE)
```

Find unique geo codes in population.
Use these to reduce GDP.

```{r}
nuts_pop <- population |> 
  select(geo) |> 
  distinct() |> 
  pull()
```

```{r}
nuts_gdp <- GDP |> 
  select(geo) |> 
  distinct() |> 
  pull()
```

```{r}
# in pop, not in GDP
nuts_inpop_notinGDP <- setdiff(nuts_pop, nuts_gdp)
```

Reduces GDP to same zones as in population.

```{r}
#filters so that only the units "MIO_EUR" are included in the data set
GDP <- GDP |>
  filter(geo %in% nuts_pop) |> 
  filter(unit == "MIO_EUR") |> 
  select(-unit)
```

### **2. GDP per Capita Calculation:**

Now we will calculate GDP per capita for each subregion.
The first thing we need to do is combine the two datasets into one:

```{r}
merged_data <- left_join(population, GDP, join_by(year, geo)) |> 
    filter(!geo %in% nuts_inpop_notinGDP)
```

```{r}
#putting together a separate merge for Norway since there have been problems with both the observations in population and gdp
NO_merged <- merged_data |> 
  filter(str_sub(geo,1,2) == "NO") 
```

```{r}
# Clean up just to get rid of datasets we dont need.
rm(GDP, population)
```

The formula we have used to find GDP per capita is:

![](images/formel.png){fig-align="center"}

```{r}
merged_data <- merged_data |> 
  mutate(
    GDP_per_capita = round(1000000*gdp/population, digits = 0)
  ) |> 
  rename(gdp_MIO = gdp)
```

In the formula we have added \*1000000 to get the number as a EUR per capita and further we have included "digits=0" to limit it down.

### **3. Descriptive Analysis:**

Furthermore, we will examine and provide interpretations for various statistical measures in the various countries;

```{r}
result <- merged_data |> 
  mutate(
    geo_2 = str_sub(geo, start = 1L, end = 2L)
  ) |> 
  filter(geo_2 %in% c("ES", "NO", "IE", "PL", 
                      "NL", "AL", "EL", "SI")
         ) |> 
# removes data for obs that have no values
# for GDP since 2008
  filter(!is.na(GDP_per_capita)) |> 
  group_by(geo_2) |> 
  summarize(
    Mean = mean(GDP_per_capita),
    Variance = var(GDP_per_capita),
    Max = max(GDP_per_capita),
    Min = min(GDP_per_capita)
  )
```

```{r}
result |> 
  knitr::kable()
```

**Comment:** We see the mean, variance, max.
and min. values in GDP per capita for each of the countries.

It may be good to note that Ireland (IE) and Norway (NO) have the highest mean, while Albania (AL) and Poland (PO) have the lowest.
We also see an extremely high range between min. and max.
values in Ireland (IE).

## Part B: Regional Inequity

### **1. Literature Review:**

Regional inequality refers to the significant disparities in economic development, resource allocation, quality of life, and access to services that exist among different geographical areas within a nation or region.These disparities may encompass varying income levels, employment opportunities, educational standards, healthcare, and the quality of infrastructure in different regions.
@zotero-118

And why do we care about regional inequality?

We care about regional inequality for several reasons.
Firstly, it is a matter of justice and social inclusion.
Inequality among regions leads to an unfair distribution of opportunities and resources, which can create social unrest and dissatisfaction among the population.
This can also result in certain areas being neglected and underdeveloped while others prosper economically and socially.
@zotero-118

Furthermore, regional inequality affects economic growth and stability.Regions with lower levels of development can impede the national economy as they do not contribute optimally to economic production.At the same time, significant disparities among regions can threaten political stability and national unity, as they can lead to conflicts and political polarization.Therefore, it is in the interest of society to reduce regional inequality to promote fairness, economic prosperity, and political harmony.
@zotero-118

### **2. Gini Coefficient Calculation:**

Next, we will calculate the population-weighted GDP Gini coefficients for each European NUTS2 level region in our countries, using the NUTS3 GDP per capita data and the formula we were given.

First we use the "merge" function to create three new columns in "merged_data" by retrieving substrings from the existing "geo" column.
This can be useful for creating categories based on different levels of NUTS geographic regions (NUTS3, NUTS2, and NUTS0) based on the first characters of "geo":

```{r}
merged_data_temp <- merged_data %>%
  mutate(id_nuts3 = geo, 
         id_nuts2 = substr(geo, 1, 4),
         id_nuts0 = substr(geo, 1, 2)) 
```

Then we use the package "magritt" to be able to update the dataframe "merged_data_temp" with the result of the subsequent operations.
We then need to filter out the rows that either have NA or 0 values.
Then we group the data by column id_nuts2" and "year". Furthermore, we add a new column called "gini_n2" in the dataframe, using the formula we were given. It calculates the Gini coefficient based on "data_per_capita" and uses "population" as weight.Finally, we remove the grouping created earlier with group_by().This is useful when you want to work with the entire dataframe again after a group operation.

```{r}
merged_data_temp %<>% 
  filter(population != "NA") %>%
filter(population != 0) %>%
  filter(GDP_per_capita != "NA") %>%
  group_by(id_nuts2, year) %>%
  mutate(gini_n2 = gini.wtd(GDP_per_capita, weights = population)) %>%
  ungroup()
```

### **3. Data Presentation**

The Gini coefficients help us assess the economic inequality of a population or the distribution of income and wealth among the members of that population.

The Gini coefficient is usually a value between 0 and 1, where 0 indicates complete equality (everyone has the same income or wealth), and 1 indicates complete inequality (one person has all the income or wealth, while everyone else has none).
@zotero-120

```{r}
result2 <- merged_data_temp |> 
  mutate(
    id_nuts2 = str_sub(id_nuts2, start = 1L, end = 2L)
  ) |> 
  filter(id_nuts2 %in% c("ES", "NO", "IE", "PL", 
                      "NL", "AL", "EL", "SI")
         ) |> 
  # tar bort data for obs som ikke har verdier 
  # for GDP helt fra 2008
  filter(!is.na(gini_n2)) |> 
  group_by(id_nuts2) |> 
  summarize(
    Mean = mean(gini_n2),
    Variance = var(gini_n2),
    Max = max(gini_n2),
    Min = min(gini_n2)
  )
```

```{r}
result2 |> 
  knitr::kable()
```

Comments:

The first thing we would like to comment on is that there are no gini values for Norway.
This is because there are missing data for Norway in both data sets from Eurostat.
We therefore do not want to include Norway further in the rescues as this gives us incomplete data.

Furthermore, we would like to comment on Poland and Ireland, which come out with the highest average in Gini value, including 0.129 and 0.162.
This is a much higher average value than, for example, Spain, which has the lowest average value of 0.0310.

## **3. Data Presentation & Discussion**

```{r}
library(ggplot2)
library(dplyr)
```

```{r}
main_data_nuts2 <- merged_data_temp %>%
  group_by(id_nuts2, year) %>%
  arrange(id_nuts2, year) %>%
  filter(row_number() == 1)
```

```{r}
#make a plot with all nuts2 values to get an overview
ggplot(main_data_nuts2, aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_point() +
  labs(title = "Scatter Plot of Gini-koeffisienter over time",
       x = "Year",
       y = "Gini-koeffisient") +
  theme_minimal()
```

Comment:

Here is a plot of all the countries we have been tasked to analyze.
When we look at the plot, we see that there are two regions from Ireland that have the highest Gini values, which are 0.249 and 0.245.
Furthermore, there are a couple of regions in the Netherlands that have a Gini value of 0.224-0.241.

```{r}

main_data_nuts2 |> 
  filter(id_nuts0 == "PL" | 
           id_nuts0 == "ES") |> 
  ggplot(aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_line() +
  labs(title = "Scatter Plot av Gini-koeffisienter over tid",
       x = "År",
       y = "Gini-koeffisient") +
  theme_minimal()
```

Comment:

We have used this code to analyze all the countries but only chose to include Spain and Poland in the plot.
This is because these countries have the most observations, and therefore give a more realistic picture of the countries.
Ireland, for example, deals with 3 regions where one region has quite a lot of development, but this gives us little insight into how the rest of the country's values are.

What is similar about both Spain and Poland is that there is a big jump in the Gini value between the lowest and the highest region.
There are three of the regions in Poland that stand out a little as they have no data observations from 2000 to 2009 and 2014.

Last comment and conclusion;

The observed variation in income inequality among regions within the assigned countries holds profound significance.
It underscores the need for targeted, region-specific interventions to address and alleviate disparities in income distribution and advance economic equity at the local level.
These variations in Gini coefficients indicate that a one-size-fits-all approach to economic policy may not be effective, as the factors driving income inequality can differ substantially between regions.

Furthermore, this regional disparity challenges political decision-makers to prioritize and consider these differences when formulating, enacting, and evaluating economic and social policies.
Policymakers must be mindful of the unique economic circumstances and challenges faced by different regions, and this awareness should inform the design of policies that aim to reduce income inequality and promote a more inclusive and equitable economic environment.
The tailored, region-specific strategies can help optimize the effectiveness of such policies, ensuring that they resonate with the specific needs and realities of each region

## Assignment 2 : Cross-Sectional Estimates

### Part A: Growth and Inequity

One theory we have is that when a country's Gross Domestic Product (GDP) per capita increases, there is a corresponding decrease in the Gini coefficient, suggesting that higher economic development is associated with reduced income inequality.

Economic growth is often associated with a decrease in income inequality.
As a country's economy expands and its Gross Domestic Product (GDP) per capita increases, more opportunities for employment, better access to education, and investments in public services become possible.
This can lead to an improvement in living standards and a more equal distribution of income among the population.

#### **1.Model Estimation:**

We are taking Norway away from maindatanuts2 because we lack observations.

```{r}
main_data2 <- main_data_nuts2 |> 
  filter(!grepl("NO", id_nuts2))
```

Furthermore, we will carry out a model estimate with regional development (yi​) as the independent variable and regional inequality (GINIWj​) as dependent variable, estimate a simple linear regression model for the year 2010.
First, we will filter the data set main_data2 to a data set that only contains data from 2010

```{r}
data_2010 <- main_data2 |> 
  filter(year == 2010)
```

As we see from the data set we receive, we only have data from 2010 in the countries Spain, Poland, the Netherlands, Slovenia and Greece.

Simple linear regression using the "lm" function.
Suppose "regional_development" is the column containing regional development (gini_n2), and "regional_inequality" is the column containing regional inequality (gdp per capita).

Looking at each country separately in regression analysis is important.
It helps us understand specific factors and variations in different countries.
This approach simplifies dealing with issues like differences in data patterns and non-linear relationships unique to each country.
By analyzing countries individually, we can get more accurate insights and make meaningful comparisons.

```{r}
library(huxtable)
library(broom)
# Filter the dataset for the year 2010
data_2010 <- main_data2 %>%
  filter(year == 2010)

# List of country codes
country_codes <- c("ES", "PL", "NL", "SI", "EL")

# Create an empty list to store regression models
regression_models <- list()

for (country_code in country_codes) {
  # Filter the dataset for each country and check for data availability
  data <- data_2010 %>%
    filter(id_nuts0 == country_code)
  
  if (nrow(data) > 0) {
    # Perform regression directly within the loop
    regression_model <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data)
    
    # Add the model to the list
    regression_models[[country_code]] <- regression_model
    
  } else {
    cat("No data found for", country_code, "in 2010\n")
  }
}
huxreg(regression_models$ES, regression_models$PL, regression_models$NL, regression_models$SI, regression_models$EL, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))


```

```{r}
library(huxtable)
library(broom)
#| echo = FALSE
# Filter the dataset for the year 2010
data_2010 <- main_data2 %>%
  filter(year == 2010)

# List of country codes
country_codes <- c("ES", "PL", "NL", "SI", "EL")

# Create an empty list to store regression models
regression_models <- list()

for (country_code in country_codes) {
  # Filter the dataset for each country and check for data availability
  data <- data_2010 %>%
    filter(id_nuts0 == country_code)
  
  if (nrow(data) > 0) {
    # Perform regression directly within the loop
    regression_model <- lm(gini_n2 ~ I(GDP_per_capita/1000), data = data)
    
    # Add the model to the list
    regression_models[[country_code]] <- regression_model
    
  } else {
    cat("No data found for", country_code, "in 2010\n")
  }
}

# Create a list of model summaries with adjusted R-squared
model_summaries <- lapply(regression_models, glance)

# Combine the summaries into a single data frame
summary_data <- do.call(rbind, model_summaries)


```

We have carried out a linear regression analysis to assess the relationship between regional development (dependent variable) and regional inequality (independent variable) for the countries in the dataset for the year 2010.

Dependent variable (Regional inequality - Gini coefficient): We have chosen the Gini coefficient as a measure of regional inequality, as it gives a quantitative indication of the distribution of income/wealth within a region.
Higher Gini coefficient indicates greater inequality.

Independent variable (Regional development - GDP per capita): We have chosen GDP per capita as the measure of regional development, as it represents the economic performance per inhabitant and can indicate the level of prosperity in a region.

#### **2.Model Diagnostics:**

**Results for ES in 2010:**

In the linear regression for Spain (ES) in 2010, a significant p-value of 0.301 was observed for GDP per capita, with an R-squared value of 0.063.
This indicates that there is no significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient) in Spain in 2010.
The low R-squared value suggests that only 6.3% of the variation in the Gini coefficient can be explained by the variability in GDP per capita.

In the linear regression for Spain (ES) in 2010, we observed the following results: The Intercept was 0.039, and for GDP per capita (Beta for GDP per capita), the value was -0.010.
This indicates a negative relationship between GDP per capita and the Gini index in Spain.
In other words, as GDP per capita increases, the Gini index decreases.

The model for Spain has a low R-squared value, indicating that the GDP_per_capita variable does not explain much of the variation in gini_n2.
The p-value for the coefficient of GDP_per_capita is also relatively high, suggesting that it may not be statistically significant.

**Results for PL in 2010:**

For Poland (PL) in 2010, the p-value for GDP per capita was 0.572, and the R-squared value was 0.037.
This again indicates no significant relationship between economic development and regional inequality for Poland in 2010.
The high p-value and low R-squared value suggest a weak explanation of the Gini coefficient based on GDP per capita.

In the case of Poland (PL) in 2010, the results were as follows: The Intercept was 0.139, and for GDP per capita (Beta for GDP per capita), the value was -0.021.
This means there is also a negative relationship between GDP per capita and the Gini index in Poland.
An increase in GDP per capita reduces the Gini index.

The model for Poland has a very low R-squared and a negative adjusted R-squared, indicating that the GDP_per_capita variable does not provide a good fit to the data.
The p-value for the coefficient of GDP_per_capita is high, suggesting it is not statistically significant.

**Results for NL in 2010:**

Netherlands (NL) in 2010 exhibited a p-value of 0.063 for GDP per capita and an R-squared value of 0.333.
This suggests a moderate relationship between economic development and regional inequality for the Netherlands in 2010.
The relatively low p-value and moderate R-squared value imply that some of the variation in the Gini coefficient can be explained by the variation in GDP per capita.

Looking at the Netherlands (NL) in 2010, the results were as follows: The Intercept was 0.167, and for GDP per capita (Beta for GDP per capita), the value was -0.037.
Again, this indicates a negative relationship between GDP per capita and the Gini index in the Netherlands.
An increase in GDP per capita reduces the Gini index.

The model for the Netherlands has a moderate R-squared value, indicating that GDP_per_capita has some explanatory power, though it is not very high.
The p-value for GDP_per_capita suggests it might be marginally significant.

**Results for SI in 2010:**

Results for Slovenia (SI) in 2010 are unusual.
There is a regression error due to the absence of residual degrees of freedom, indicating insufficient variation in the data to perform a meaningful regression.
These results should not be interpreted due to this error.

The model for Slovenia has a perfect R-squared of 1, but it also indicates there are no degrees of freedom, suggesting a problem with the model.
This could be due to a very small sample size.

**Results for EL in 2010:**

Greece (EL) in 2010 displayed a significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient).
The p-value was 0.010, and the R-squared value was 0.470.
This indicates that an increase in GDP per capita is associated with a significant increase in the Gini coefficient for Greece in 2010.

For Greece (EL) in 2010, the following findings were made: The Intercept was -0.026 and for GDP per capita (Beta for GDP per capita), the value was 0.048.
This suggests a positive relationship between GDP per capita and the Gini index for Greece.
An increase in GDP per capita leads to an increase in the Gini index.

The model for Greece has a relatively high R-squared, indicating that the GDP_per_capita variable explains a substantial portion of the variation in gini_n2.
The p-value for GDP_per_capita is low, suggesting it is statistically significant.

In summary, the models for Spain and Poland have low R-squared values, indicating that GDP_per_capita does not explain much of the variation in gini_n2.
The models for the Netherlands and Greece show better fits with higher R-squared values, suggesting that GDP_per_capita has more explanatory power in these cases.
However, it's essential to consider the context and the specific dataset when interpreting these results.
Additionally, be cautious with the model for Slovenia due to the lack of degrees of freedom, which may indicate issues with the data or the model.

In summary, the reliability and validity of the models vary across countries.
Spain and Poland's models have low R-squared values, questioning their reliability and validity.
The Netherlands shows a somewhat better fit, but its validity depends on the context.
The model for Slovenia is unreliable due to a lack of degrees of freedom.
Finally, Greece's model appears reliable and valid, with a high R-squared and low p-value.
However, it's crucial to consider the specific context and dataset when interpreting these results and to be cautious with models that have low R-squared values or other statistical issues.

As some of the countries may not show a significant linear relationship between regional development and regional inequality for the year 2010.
This is particularly evident for Slovenia (SI), where the results indicate that there is no significant relationship due to missing data.

In addition, it may appear that Poland (PL) and Greece (EL) also have weak and non-significant relationships, as shown by the high p-values ​​and low R-squared values.

We can further consider including only the countries Spain (ES) and the Netherlands (NL) in the task, as these have lower p-values ​​and higher R-squared values, even if the relationships are not necessarily strong.

In summary, the models for Spain and Poland have low R-squared values, indicating that GDP_per_capita does not explain much of the variation in gini_n2.
The models for the Netherlands and Greece show better fits with higher R-squared values, suggesting that GDP_per_capita has more explanatory power in these cases.
However, it's essential to consider the context and the specific dataset when interpreting these results.
Additionally, be cautious with the model for Slovenia due to the lack of degrees of freedom, which may indicate issues with the data or the model.

In summary, the reliability and validity of the models vary across countries.
Spain and Poland's models have low R-squared values, questioning their reliability and validity.
The Netherlands shows a somewhat better fit, but its validity depends on the context.
The model for Slovenia is unreliable due to a lack of degrees of freedom.
Finally, Greece's model appears reliable and valid, with a high R-squared and low p-value.
However, it's crucial to consider the specific context and dataset when interpreting these results and to be cautious with models that have low R-squared values or other statistical issues.

As some of the countries may not show a significant linear relationship between regional development and regional inequality for the year 2010.
This is particularly evident for Slovenia (SI), where the results indicate that there is no significant relationship due to missing data.

In addition, it may appear that Poland (PL) and Greece (EL) also have weak and non-significant relationships, as shown by the high p-values ​​and low R-squared values.

We can further consider including only the countries Spain (ES) and the Netherlands (NL) in the task, as these have lower p-values ​​and higher R-squared values, even if the relationships are not necessarily strong.

#### **3.Visualization:**

```{r}
#| echo = FALSE
#Remove rows with missing values
test <- data_2010[complete.cases(data_2010),]

# Filter the dataset for only Spain (ES) and Netherlands (NL)
subset_data <- subset(test, id_nuts0 %in% c("ES", "NL"))

# Create a scatterplot with a regression line

library(ggplot2)

# Filter the dataset for only Spain (ES)
subset_data_es <- subset_data[subset_data$id_nuts0 == "ES", ]

# Create a scatterplot with a regression line for Spain (ES)
ggplot(subset_data_es, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +

  labs(
    title = "Scatter Plot for Spain (ES): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()

```

```{r}
# Filter the dataset for only Netherlands (NL)
subset_data_nl <- subset_data[subset_data$id_nuts0 == "NL", ]

# Create a scatterplot with a regression line for Netherlands (NL)
ggplot(subset_data_nl, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +
  labs(
    title = "Scatter Plot for Netherlands (NL): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()

```

#### Part B: Exploring Other Determinants of Inequity

**1.Data Acquisition:**

```{r}
#making a new dataset only for Spain and Netherlands for 2010
SN2010 <- data_2010 |> 
  filter(id_nuts0 %in% c("ES", "NL"))
```

We have chosen to add three data sets that we will use as variables into our subset data to see what impact innovation, farms and highways have on regional inequality.

We hypothesize that the number of newly established companies, the area of farms, and the length of highways in a region have a significant impact on regional inequality in both Spain and the Netherlands.
Specifically, we expect that an increase in the number of newly established companies and the area of farms in the region will be associated with a decrease in regional inequality, while an increase in highway length may also have an impact on regional inequality We can conduct analyses to test this hypothesis using statistical methods to determine if the variables indeed have a significant impact on regional inequality in the two countries.

```{r}
library(readr)
highway <- read_csv("motorvei.csv")
innovation <- read_csv("innovation.csv")
farm <- read_csv("gard.csv")
```

We use the "select" command to select the columns we need as we are only interested in obs value, year and geo code.

```{r}
#we rename one of the variables and select the ones we want
highway <- highway |> 
  select(KM = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
farm <- farm |> 
  select(Area = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
innovation <- innovation |> 
  select(newfirms = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
```

```{r}
#A small comment on the dataset "innovation" is that it is data from 2013 and not 2010. So we mutate it to 2010. 
innovation <- innovation |> 
  mutate(year = 2010)
```

**2.Multiple Linear Regression Model:**

First, we test whether newly established companies in a region have a significant impact on regional inequality in both Spain and the Netherlands.

```{r}
#we merge the dataset SN2010 and innovation together
merged_innovation <- left_join(SN2010, innovation, join_by(year, id_nuts2))
```

```{r}
#making a regression model with the variabels gini_n2 and newfirms
regression_innovation <- lm(gini_n2 ~ newfirms, data = merged_innovation)
huxreg(regression_innovation, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Comment to the regression model; As we can read from the regression model, "new firms" does not have a significant linear relationship with regional inequality, as measured by "gini_n2," in the data set for the year 2010.
The coefficient for "new firms" is small and not statistically significant, and the model explains very little of the variation in regional inequality.

Furthermore, we will include the variable "population" as a control variable in the regression analysis to gain a better understanding of the relationship between the number of new start-up firms ("newfirms") and regional inequality ("gini_n2").
This can help to explain any connections that may arise as a result of the size of the population in a region.

```{r}
regression_innovationp <- lm(gini_n2 ~ newfirms + population, data = merged_innovation)
huxreg(regression_innovationp, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Overall, the results of the regression analysis do not provide strong support for the hypothesis that the number of new start-up firms has a significant impact on regional inequality in the data set for the year 2010.
It is important to note that this is based on available data, and there may be other factors that plays a role in regional inequality, which is not included in the model.

Now we will create a new regression model to see if farms have an impact on regional inequality

```{r}
merged_farm <- left_join(merged_innovation, farm, join_by(year, id_nuts2))
```

```{r}
regression_farm <- lm(gini_n2 ~ Area, data = merged_farm)
huxreg(regression_farm, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Comment to the regression modell: In summary, the results from this model can be interpreted as that changes in the regions' area do not have a significant linear relationship with regional inequality.
The model does not provide a good explanation for the variation in "gini_n2" based on area alone.
Although there is a positive coefficient (2.457e-09), the change in regional inequality caused by changes in area is so minimal that it is not significant enough to say that there is a linear relationship.

Finally, we want to include the variable KM from the highway data set to see if this can have an impact on regional inequalities in the two countries.

```{r}
merged_highway <- left_join(merged_farm, highway, join_by(year, id_nuts2))
```

```{r}
regression_highway <- lm(gini_n2 ~ KM, data = merged_highway)
huxreg(regression_highway, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Comment to the regression modell: We see that the coefficient is estimated at 3.448e-06.
Again, this is a very small value.
This small coefficient suggests that the increase in the length of highways in the regions has a very small influence on the change in the "gini_n2" value.
In addition, the p-value for "KM" is 0.73, which is higher than the usual significance level (for example, 0.05 ).
This indicates that the coefficient for "KM" is not significant and there is no evidence of a linear relationship between the length of highways and regional inequality (gini level) in 2010.

**3.Model Interpretation:**

## References
