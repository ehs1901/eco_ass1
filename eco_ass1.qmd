---
title: "Assignments - econometrics"
format: pdf
editor: visual
bibliography: references.bib
author: Emilie and Ingrid
---

## Assignment 1: Data and Descriptive

This assignment is intended to gather, process, and analyze sub-national GDP and population data for a selection of European countries.
We will calculate GDP per capita and investigate regional disparities using various descriptive statistics and visualizations.
The data sets are taken from Eurostat.

We have been tasked with analyzing Ireland (IE), Poland (PL), Spain (ES), Slovenia (SI), the Netherlands(NL), Greece (EL), Norway (NO), Albania(AL) from the year 2000 to 2020.

When we had been working on the assignment for a while, we realized that we had downloaded a dataset for GDP.
Given that we had already performed several calculations, we decided to select the countries we no longer needed instead of reloading the dataset.
As a result, there are a few chunks that include selections to ensure the dataset was adjusted accordingly.

```{r}
#| label: setup
#| message: false
#| output: false
#| echo: FALSE
library(tidyverse)
library(dplyr)
library(dineq)
library(ineq)
library(magrittr)
library(huxtable)
library(broom)
library(readr)
library(lmtest)
library(plm)
```

## Part A : Sub-national GDP and GDP per Capita

### **1 . Data Acquisition:**

#### Dataset: GDP

This dataset is a sub-regional GDP dataset for a selection of our European countries.
GDP stands for Gross Domestic Product, and it is a key economic indicator used to measure the overall economic health and performance of a country or region @zotero-122.
The variables relevant to us are;

GEO: this variable show us the geopolitical entity.

Time_Period: this variable shows us the time period in years.

Obs_Value: this variable shows us the value of GDP.

@zotero-126

```{r}
GDP <- read_csv("GDP.csv", show_col_types = FALSE)
```

```{r}
#In order to obtain accurate GDP figures, we had to select 'MIO_EUR' as the unit, as it represents the GDP values.
NO_GDP <- GDP |> 
  filter(str_sub(geo,1,2) == "NO") |> 
  filter(unit == "MIO_EUR")
```

```{r}
dim(GDP)
```

As mentioned earlier, we initially had all the countries in a single dataset and had to perform selections accordingly.
Will therefor reduce it after getting population.

Before we start calculating the GDP per inhabitant for each sub-region, we want to "clean up" the dataset so that we only include the necessary variables:

```{r}
#| echo: FALSE
# We rename one of the variables and select the ones we want
GDP <- GDP |> 
  select(year = TIME_PERIOD, unit, geo, gdp = OBS_VALUE)
```

#### Dataset: Population

This dataset is a dataset about population for a selection of our European countries.
Population refers to the total number of individuals of a particular species or group inhabiting a specific area or planet at a given time.The variables relevant to us are;

GEO: this variable show us the geopolitical entity.

Time_Period: this variable shows us the time period in years.

Obs_Value: this variable shows us the value of population.

@zotero-124

```{r}
#| echo: FALSE
population <- read_csv("population.csv", show_col_types = FALSE)
```

We will do the same as on the previous data set by selecting the necessary variables:

```{r}
# We rename one of the variables and select the ones we want
population <- population |> 
  select(year = TIME_PERIOD, geo, population = OBS_VALUE)
```

Find unique geo codes in population.
Use these to reduce GDP.

```{r}
nuts_pop <- population |> 
  select(geo) |> 
  distinct() |> 
  pull()
```

```{r}
nuts_gdp <- GDP |> 
  select(geo) |> 
  distinct() |> 
  pull()
```

```{r}
#| echo: FALSE
# in pop, not in GDP
nuts_inpop_notinGDP <- setdiff(nuts_pop, nuts_gdp)
```

Reduces GDP to same zones as in population.

```{r}
#filters so that only the units "MIO_EUR" are included in the data set
GDP <- GDP |>
  filter(geo %in% nuts_pop) |> 
  filter(unit == "MIO_EUR") |> 
  select(-unit)
```

### **2. GDP per Capita Calculation:**

Now we will calculate GDP per capita for each subregion.
The first thing we need to do is combine the two datasets into one:

```{r}
merged_data <- left_join(population, GDP, join_by(year, geo)) |> 
    filter(!geo %in% nuts_inpop_notinGDP)
```

```{r}
#| echo: FALSE
#putting together a separate merge for Norway since there have been problems with both the observations in population and gdp
NO_merged <- merged_data |> 
  filter(str_sub(geo,1,2) == "NO") 
```

```{r}
#| echo: FALSE
# Clean up just to get rid of datasets we dont need.
rm(GDP, population)
```

The formula we have used to find GDP per capita is:

![](images/formel.png){fig-align="center"}

```{r}
#| echo: FALSE
merged_data <- merged_data |> 
  mutate(
    GDP_per_capita = round(1000000*gdp/population, digits = 0)
  ) |> 
  rename(gdp_MIO = gdp)
```

In the formula we have added \*1000000 to get the number as a EUR per capita and further we have included "digits=0" to limit it down.

### **3. Descriptive Analysis:**

Furthermore, we will examine and provide interpretations for various statistical measures in the various countries;

```{r}
#| echo: FALSE
result <- merged_data |> 
  mutate(
    geo_2 = str_sub(geo, start = 1L, end = 2L)
  ) |> 
  filter(geo_2 %in% c("ES", "NO", "IE", "PL", 
                      "NL", "AL", "EL", "SI")
         ) |> 
# removes data for obs that have no values
# for GDP since 2008
  filter(!is.na(GDP_per_capita)) |> 
  group_by(geo_2) |> 
  summarize(
    Mean = mean(GDP_per_capita),
    Variance = var(GDP_per_capita),
    Max = max(GDP_per_capita),
    Min = min(GDP_per_capita)
  )
```

```{r}
#| echo: FALSE
result |> 
  knitr::kable()
```

**Comment:** We see the mean, variance, max.
and min. values in GDP per capita for each of the countries.

It may be good to note that Ireland (IE) and Norway (NO) have the highest mean, while Albania (AL) and Poland (PO) have the lowest.
We also see an extremely high range between min. and max.
values in Ireland (IE).

## Part B: Regional Inequity

### **1. Literature Review:**

Regional inequality refers to the significant disparities in economic development, resource allocation, quality of life, and access to services that exist among different geographical areas within a nation or region.These disparities may encompass varying income levels, employment opportunities, educational standards, healthcare, and the quality of infrastructure in different regions.
@zotero-118

And why do we care about regional inequality?

We care about regional inequality for several reasons.
Firstly, it is a matter of justice and social inclusion.
Inequality among regions leads to an unfair distribution of opportunities and resources, which can create social unrest and dissatisfaction among the population.
This can also result in certain areas being neglected and underdeveloped while others prosper economically and socially.
@zotero-118

Furthermore, regional inequality affects economic growth and stability.Regions with lower levels of development can impede the national economy as they do not contribute optimally to economic production.At the same time, significant disparities among regions can threaten political stability and national unity, as they can lead to conflicts and political polarization.Therefore, it is in the interest of society to reduce regional inequality to promote fairness, economic prosperity, and political harmony.
@zotero-118

### **2. Gini Coefficient Calculation:**

Next, we will calculate the population-weighted GDP Gini coefficients for each European NUTS2 level region in our countries, using the NUTS3 GDP per capita data and the formula we were given.

First we use the "merge" function to create three new columns in "merged_data" by retrieving substrings from the existing "geo" column.
This can be useful for creating categories based on different levels of NUTS geographic regions (NUTS3, NUTS2, and NUTS0) based on the first characters of "geo":

```{r}
merged_data_temp <- merged_data %>%
  mutate(id_nuts3 = geo, 
         id_nuts2 = substr(geo, 1, 4),
         id_nuts0 = substr(geo, 1, 2)) 
```

Then we use the package "magritt" to be able to update the dataframe "merged_data_temp" with the result of the subsequent operations.
We then need to filter out the rows that either have NA or 0 values.
Then we group the data by column id_nuts2" and "year". Furthermore, we add a new column called "gini_n2" in the dataframe, using the formula we were given. It calculates the Gini coefficient based on "data_per_capita" and uses "population" as weight.Finally, we remove the grouping created earlier with group_by().This is useful when you want to work with the entire dataframe again after a group operation.

```{r}
#| echo: FALSE
merged_data_temp %<>% 
  filter(population != "NA") %>%
filter(population != 0) %>%
  filter(GDP_per_capita != "NA") %>%
  group_by(id_nuts2, year) %>%
  mutate(gini_n2 = gini.wtd(GDP_per_capita, weights = population)) %>%
  ungroup()
```

### **3. Data Presentation**

The Gini coefficients help us assess the economic inequality of a population or the distribution of income and wealth among the members of that population.

The Gini coefficient is usually a value between 0 and 1, where 0 indicates complete equality (everyone has the same income or wealth), and 1 indicates complete inequality (one person has all the income or wealth, while everyone else has none).
@zotero-120

```{r}
#| echo: FALSE
result2 <- merged_data_temp |> 
  mutate(
    id_nuts2 = str_sub(id_nuts2, start = 1L, end = 2L)
  ) |> 
  filter(id_nuts2 %in% c("ES", "NO", "IE", "PL", 
                      "NL", "AL", "EL", "SI")
         ) |> 
  # tar bort data for obs som ikke har verdier 
  # for GDP helt fra 2008
  filter(!is.na(gini_n2)) |> 
  group_by(id_nuts2) |> 
  summarize(
    Mean = mean(gini_n2),
    Variance = var(gini_n2),
    Max = max(gini_n2),
    Min = min(gini_n2)
  )
```

```{r}
#| echo: FALSE
result2 |> 
  knitr::kable()
```

Comments:

The first thing we would like to comment on is that there are no gini values for Norway.
This is because there are missing data for Norway in both data sets from Eurostat.
We therefore do not want to include Norway further in the rescues as this gives us incomplete data.

Furthermore, we would like to comment on Poland and Ireland, which come out with the highest average in Gini value, including 0.129 and 0.162.
This is a much higher average value than, for example, Spain, which has the lowest average value of 0.0310.

## **3. Data Presentation & Discussion**

```{r}
#| echo: FALSE
library(ggplot2)
library(dplyr)
```

```{r}
#| echo: FALSE
main_data_nuts2 <- merged_data_temp %>%
  group_by(id_nuts2, year) %>%
  arrange(id_nuts2, year) %>%
  filter(row_number() == 1)
```

```{r}
#| echo: FALSE
#make a plot with all nuts2 values to get an overview
ggplot(main_data_nuts2, aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_point() +
  labs(title = "Scatter Plot of Gini-koeffisienter over time",
       x = "Year",
       y = "Gini-koeffisient") +
  theme_minimal()
```

Comment:

Here is a plot of all the countries we have been tasked to analyze.
When we look at the plot, we see that there are two regions from Ireland that have the highest Gini values, which are 0.249 and 0.245.
Furthermore, there are a couple of regions in the Netherlands that have a Gini value of 0.224-0.241.

```{r}
#| echo: FALSE
main_data_nuts2 |> 
  filter(id_nuts0 == "PL" | 
           id_nuts0 == "ES") |> 
  ggplot(aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_line() +
  labs(title = "Scatter Plot av Gini-koeffisienter over tid",
       x = "År",
       y = "Gini-koeffisient") +
  theme_minimal()
```

Comment:

We have used this code to analyze all the countries but only chose to include Spain and Poland in the plot.
This is because these countries have the most observations, and therefore give a more realistic picture of the countries.
Ireland, for example, deals with 3 regions where one region has quite a lot of development, but this gives us little insight into how the rest of the country's values are.

What is similar about both Spain and Poland is that there is a big jump in the Gini value between the lowest and the highest region.
There are three of the regions in Poland that stand out a little as they have no data observations from 2000 to 2009 and 2014.

Last comment and conclusion;

The observed variation in income inequality among regions within the assigned countries holds profound significance.
It underscores the need for targeted, region-specific interventions to address and alleviate disparities in income distribution and advance economic equity at the local level.
These variations in Gini coefficients indicate that a one-size-fits-all approach to economic policy may not be effective, as the factors driving income inequality can differ substantially between regions.

Furthermore, this regional disparity challenges political decision-makers to prioritize and consider these differences when formulating, enacting, and evaluating economic and social policies.
Policymakers must be mindful of the unique economic circumstances and challenges faced by different regions, and this awareness should inform the design of policies that aim to reduce income inequality and promote a more inclusive and equitable economic environment.
The tailored, region-specific strategies can help optimize the effectiveness of such policies, ensuring that they resonate with the specific needs and realities of each region

# Assignment 2 : Cross-Sectional Estimates

### Part A: Growth and Inequity

One theory we have is that when a country's Gross Domestic Product (GDP) per capita increases, there is a corresponding decrease in the Gini coefficient, suggesting that higher economic development is associated with reduced income inequality.

Economic growth is often associated with a decrease in income inequality.
As a country's economy expands and its Gross Domestic Product (GDP) per capita increases, more opportunities for employment, better access to education, and investments in public services become possible.
This can lead to an improvement in living standards and a more equal distribution of income among the population.

#### **1.Model Estimation:**

We will carry out a model estimate with regional development (yi​) as the independent variable and regional inequality (GINIWj​) as dependent variable, and we will estimate a simple linear regression model for the year 2010.
First, we will filter the data set main_data2 to a data set that only contains data from 2010.

```{r}
#| echo: FALSE
# remove Norway as we were not going to use it further in the assignment as mentioned earlier
main_data2 <- main_data_nuts2 |> 
  filter(!grepl("NO", id_nuts2))
```

As we see from the data set we receive, we only have data from 2010 in the countries Spain, Poland, the Netherlands, Slovenia and Greece.

We want to look at each country separately in the regression analysis.
It helps us understand specific factors and variations in different countries.
This approach simplifies dealing with issues such as differences in data patterns and non-linearities unique to each country.
By analyzing countries individually, we can gain more accurate insights and make meaningful comparisons.

Dependent variable (Regional inequality - Gini coefficient): We have chosen the Gini coefficient as a measure of regional inequality, as it gives a quantitative indication of the distribution of income/wealth within a region.
Higher Gini coefficient indicates greater inequality.

Independent variable (Regional development - GDP per capita): We have chosen GDP per capita as the measure of regional development, as it represents the economic performance per inhabitant and can indicate the level of prosperity in a region.

```{r}
#| echo: FALSE
# Filter the dataset for the year 2010
data_2010 <- main_data2 %>%
  filter(year == 2010)

# List of country codes
country_codes <- c("ES", "PL", "NL", "SI", "EL")

# Create an empty list to store regression models
regression_models <- list()

for (country_code in country_codes) {
  # Filter the dataset for each country and check for data availability
  data <- data_2010 %>%
    filter(id_nuts0 == country_code)
  
  if (nrow(data) > 0) {
    # Perform regression directly within the loop
    regression_model <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data)
    
    # Add the model to the list
    regression_models[[country_code]] <- regression_model
    
  } else {
    cat("No data found for", country_code, "in 2010\n")
  }
}
```

```{r}
#| echo: FALSE
#| label: tbl-en
#| tbl-cap: "linear regression analysis to assess the relationship between regional development (dependent variable) and regional inequality (independent variable) for the countries in the dataset for the year 2010"
huxreg(regression_models$ES, regression_models$PL, regression_models$NL, regression_models$SI, regression_models$EL, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

#### **2.Model Diagnostics:**

reading off @tbl-en:

**Results for ES in 2010 - Model (1)**

In the linear regression for Spain (ES) in 2010, a significant p-value of 0.301 was observed for GDP per capita, with an R-squared value of 0.063.
This indicates that there is no significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient) in Spain in 2010.
The low R-squared value suggests that only 6.3% of the variation in the Gini coefficient can be explained by the variability in GDP per capita.

In the linear regression for Spain (ES) in 2010, we observed the following results: The Intercept was 0.039, and for GDP per capita (Beta for GDP per capita), the value was -0.010.
This indicates a negative relationship between GDP per capita and the Gini index in Spain.
In other words, as GDP per capita increases, the Gini index decreases.

The model for Spain has a low R-squared value, indicating that the GDP_per_capita variable does not explain much of the variation in gini_n2.
The p-value for the coefficient of GDP_per_capita is also relatively high, suggesting that it may not be statistically significant.

**Results for PL in 2010 - Model (2)**

For Poland (PL) in 2010, the p-value for GDP per capita was 0.572, and the R-squared value was 0.037.
This again indicates no significant relationship between economic development and regional inequality for Poland in 2010.
The high p-value and low R-squared value suggest a weak explanation of the Gini coefficient based on GDP per capita.

In the case of Poland (PL) in 2010, the results were as follows: The Intercept was 0.139, and for GDP per capita (Beta for GDP per capita), the value was -0.021.
This means there is also a negative relationship between GDP per capita and the Gini index in Poland.
An increase in GDP per capita reduces the Gini index.

The model for Poland has a very low R-squared and a negative adjusted R-squared, indicating that the GDP_per_capita variable does not provide a good fit to the data.
The p-value for the coefficient of GDP_per_capita is high, suggesting it is not statistically significant.

**Results for NL in 2010 - Model (3)**

Netherlands (NL) in 2010 exhibited a p-value of 0.063 for GDP per capita and an R-squared value of 0.333.
This suggests a moderate relationship between economic development and regional inequality for the Netherlands in 2010.
The relatively low p-value and moderate R-squared value imply that some of the variation in the Gini coefficient can be explained by the variation in GDP per capita.

Looking at the Netherlands (NL) in 2010, the results were as follows: The Intercept was 0.167, and for GDP per capita (Beta for GDP per capita), the value was -0.037.
Again, this indicates a negative relationship between GDP per capita and the Gini index in the Netherlands.
An increase in GDP per capita reduces the Gini index.

The model for the Netherlands has a moderate R-squared value, indicating that GDP_per_capita has some explanatory power, though it is not very high.
The p-value for GDP_per_capita suggests it might be marginally significant.

**Results for SI in 2010 - Model (4)**

Results for Slovenia (SI) in 2010 are unusual.
There is a regression error due to the absence of residual degrees of freedom, indicating insufficient variation in the data to perform a meaningful regression.
These results should not be interpreted due to this error.

The model for Slovenia has a perfect R-squared of 1, but it also indicates there are no degrees of freedom, suggesting a problem with the model.
This could be due to a very small sample size.

**Results for EL in 2010 - Model (5)**

Greece (EL) in 2010 displayed a significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient).
The p-value was 0.010, and the R-squared value was 0.470.
This indicates that an increase in GDP per capita is associated with a significant increase in the Gini coefficient for Greece in 2010.

For Greece (EL) in 2010, the following findings were made: The Intercept was -0.026 and for GDP per capita (Beta for GDP per capita), the value was 0.048.
This suggests a positive relationship between GDP per capita and the Gini index for Greece.
An increase in GDP per capita leads to an increase in the Gini index.

The model for Greece has a relatively high R-squared, indicating that the GDP_per_capita variable explains a substantial portion of the variation in gini_n2.
The p-value for GDP_per_capita is low, suggesting it is statistically significant.

**Summary :**

Furthermore, in the thesis we want to include Spain, Greece and the Netherlands.
Will choose to include Spain (ES) and the Netherlands (NL) further in the thesis, even though they showed that the connections between GDP per capita and the Gini coefficient are often not very strong.
This is because they still have lower p-values and higher R-squared values compared to the other countries.
This indicates that there is a certain degree of explanatory power in these two models, although the connections may not be very strong.

In the case of Greece (EL), the results actually show a significant positive correlation between regional inequality (Gini coefficient) and economic development (GDP per capita).
This indicates that the increase in GDP per capita is associated with a significant increase in the Gini coefficient for Greece in 2010.
Therefore, Greece will be an important country to include in our further analysis and discussion in the thesis.
It is particularly important to look for positive correlations between economic development and regional inequality.

#### **3.Visualization:**

```{r}
#| echo: FALSE
#Remove rows with missing values
test <- data_2010[complete.cases(data_2010),]
# Filter the dataset for only Spain (ES) and Netherlands (NL) and Greece (EL)
subset_data <- subset(test, id_nuts0 %in% c("ES", "NL", "EL"))
# Filter the dataset for only Spain (ES)
subset_data_es <- subset_data[subset_data$id_nuts0 == "ES", ]
```

```{r}
#| echo: FALSE
#| label: fig-to
#| fig-cap: "Scatter Plot for Spain (ES): Regional Development vs. Regional Inequality"
# Create a scatterplot with a regression line for Spain (ES)
ggplot(subset_data_es, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +

  labs(
    title = "Scatter Plot for Spain (ES): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

```{r}
#| echo: FALSE
subset_data_nl <- subset_data[subset_data$id_nuts0 == "NL", ]
```

```{r}
#| echo: FALSE
#| label: fig-tre
#| fig-cap: "Scatter Plot for Netherlands (NL): Regional Development vs. Regional Inequality"
# Filter the dataset for only Netherlands (NL)
# Create a scatterplot with a regression line for Netherlands (NL)
ggplot(subset_data_nl, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +
  labs(
    title = "Scatter Plot for Netherlands (NL): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

```{r}
#| echo: FALSE
subset_data_el <- subset_data[subset_data$id_nuts0 == "EL", ]
```

```{r}
#| echo: FALSE
#| label: fig-fire
#| fig-cap: "Scatter Plot for Greece (EL): Regional Development vs. Regional Inequality"
subset_data |> 
  filter(id_nuts0 == "EL") |> 
  ggplot(aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +
  labs(
    title = "Scatter Plot for Greece (EL): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

Comment: following @fig-to and @fig-tre: both Spain and the Netherlands have a downward slope, the Netherlands a steeper slope than Spain.
If we look at @fig-fire, Greece, on the other hand, we see that the line is going up.
This supports our results from the regression model with that Greece shows a significant positive correlation between regional inequality (Gini coefficient) and economic development (GDP per capita).

\clearpage

#### Part B: Exploring Other Determinants of Inequity

**1.Data Acquisition:**

```{r}
#| echo: FALSE
#making a new dataset only for Spain, Netherlands and Greece for 2010
SN2010 <- data_2010 |> 
  filter(id_nuts0 %in% c("ES", "NL", "EL"))
```

```{r}
#| echo: FALSE
highway <- read_csv("motorvei2.csv", show_col_types = FALSE)
innovation <- read_csv("innovation.csv", show_col_types = FALSE)
farm <- read_csv("farm1.csv", show_col_types = FALSE)
```

We have chosen to add three data sets that we will use as variables into our subset data to see what impact innovation, farms and highways have on regional inequality.
@zotero-124 @zotero-126 @zotero-148

We hypothesize that the number of newly established companies, farm area, and the length of highways in a region have a significant impact on regional inequality in Spain, the Netherlands, and Greece.
More specifically, we expect that an increase in the number of newly established companies and farm area in the region will be associated with a reduction in regional inequality, while an increase in the length of highways may also impact regional inequality.
We will conduct analyses to test this hypothesis using statistical methods to assess whether the variables indeed have a significant effect on regional inequality in the three countries.

```{r}
#| echo: FALSE
#we rename one of the variables and select the ones we want
highway <- highway |> 
  select(KM = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
farm <- farm |> 
  select(Area = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
innovation <- innovation |> 
  select(newfirms = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
```

```{r}
#| echo: FALSE
#A small comment on the dataset "innovation" is that it is data from 2013 and not 2010. So we mutate it to 2010. 
innovation <- innovation |> 
  mutate(year = 2010)
```

**2.Multiple Linear Regression Model:**

The one data set we have chosen to include as a variable does not have data from Greece, so we will only get figures for Spain and the Netherlands when we look at whether new firms have an impact on regional inequality.

```{r}
#| echo: FALSE
#we merge the dataset SN2010 and innovation together
merged_innovation <- left_join(SN2010, innovation, join_by(year, id_nuts2))
```

```{r}
#| echo: FALSE
#| label: tbl-to
#| tbl-cap: "regression models for Spain, the Netherlands - innovation"
# Create a list of regression models for Spain, the Netherlands
regression_models_2countries <- list()

# Filter the dataset for each country and check for data availability
data_es <-  merged_innovation %>% filter(id_nuts0 == "ES")
data_nl <- merged_innovation %>% filter(id_nuts0 == "NL")

# Perform regression for Spain
regression_model_es <- lm(gini_n2 ~ newfirms, data = data_es)
regression_models_2countries$ES <- regression_model_es

# Perform regression for the Netherlands
regression_model_nl <- lm(gini_n2 ~ newfirms, data = data_nl)
regression_models_2countries$NL <- regression_model_nl

huxreg(regression_models_2countries$ES,regression_models_2countries$NL,
statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))

```

Comment to @tbl-to

For Spain (1), a linear regression analysis was conducted to assess the relationship between the number of newly established companies (newfirms) and regional inequality (Gini coefficient) in 2010.
The results show no significant linear relationship between these two variables, with a p-value of 0.444.
The low R-squared value (0.03486) also indicates limited explanatory power, with only 3.486% of the variation in the Gini coefficient explained by the variation in the number of newly established companies.
This suggests that the number of new firms alone is not sufficient to explain regional inequality in Spain.

Similarly, for the Netherlands (2), a similar analysis was performed, and the results are consistent.
There is also no significant linear relationship between the number of newly established companies and the Gini coefficient, with a p-value of 0.6316.
The R-squared value is low (0.02663), indicating that only 2.663% of the variation in the Gini coefficient can be explained by the variation in the number of newly established companies.
This suggests that in the Netherlands in 2010, the number of new firms does not have a significant impact on regional inequality.

Furthermore, we will include the variable "population" as a control variable in the regression analysis to gain a better understanding of the relationship between the number of new start-up firms ("newfirms") and regional inequality ("gini_n2").
This can help to explain any connections that may arise as a result of the size of the population in a region.

```{r}
#| echo: FALSE
# Making a regression model with the variables gini_n2, newfirms, and population
regression_innovationp_es <- lm(gini_n2 ~ I(newfirms/10000) + I(population/1000000), data = merged_innovation %>% filter(id_nuts0 == "ES"))
regression_innovationp_nl <- lm(gini_n2 ~ I(newfirms/10000) + I(population/1000000), data = merged_innovation %>% filter(id_nuts0 == "NL"))
```

```{r}
#| echo: FALSE
#| label: tbl-three
#| tbl-cap: "regression models for Spain, the Netherlands - innovation and population"
huxreg(regression_innovationp_es, regression_innovationp_nl, statistics =  c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Comment to @tbl-three

Spain (1):

The regression analysis for Spain indicates a significant positive relationship between the number of newly established companies and regional inequality in 2010.
For each increase in the number of new firms, regional inequality increases.
At the same time, the analysis shows a negative relationship between population size and regional inequality.
This means that areas with larger populations have lower regional inequality.
The model for Spain is statistically significant and explains 27.35% of the variation in regional inequality.

Netherlands (2):

The regression analysis for the Netherlands shows that neither the number of newly established companies nor population size has a significant impact on regional inequality in 2010.
This means that the variation in these factors does not explain the variation in regional inequality in the Netherlands.
The model for the Netherlands is not statistically significant, and it has very low explanatory power, with only 1.621% of the variation in regional inequality explained.

Now we will create a new regression model to see if farms have an impact on regional inequality.
Here we will include Greece again.

```{r}
#| echo: FALSE
merged_farm <- left_join(SN2010, farm, join_by(year, id_nuts2))
```

```{r}
#| echo: FALSE
#| label: tbl-four
#| tbl-cap: "regression models for Spain,Netherlands and greece - farm"
regression_farm_es <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "ES"))
regression_farm_nl <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "NL"))
regression_farm_el <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "EL"))
huxreg(regression_farm_es, regression_farm_nl, regression_farm_el, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

comment to @tbl-four

Spain (1):

For Spain, the results indicate a moderate positive relationship between agricultural area ("farm") and regional inequality (Gini coefficient).
The p-value is 0.0309, which is lower than the typical significance level of 0.05, suggesting that agricultural area may have a significant impact on regional inequality.
The adjusted R-squared is 0.2014, meaning that 20.14% of the variation in the Gini coefficient can be explained by the variation in agricultural area.

Netherlands (2):

For the Netherlands, the results show no significant relationship between agricultural area and regional inequality.
The p-value is 0.532, which is higher than the usual significance level, indicating that agricultural area does not have a significant impact on regional inequality.
The adjusted R-squared is -0.06125, suggesting that agricultural area does not provide a good fit to the data.

Greece (3):

For Greece, the results also indicate no significant relationship between agricultural area and regional inequality.
The p-value is 0.283, which is higher than the usual significance level, suggesting that agricultural area does not have a significant impact on regional inequality.
The adjusted R-squared is 0.2712, meaning that 27.12% of the variation in the Gini coefficient can be explained by the variation in agricultural area.

Finally, we want to include the variable KM from the highway data set to see if this can have an impact on regional inequalities in the countries.
There is also missing values from Greece in this dataset so the regression will only be for Spain and Netherlands.

```{r}
#| echo: FALSE
merged_highway <- left_join(merged_farm, highway, join_by(year, id_nuts2))
```

```{r}
#| echo: FALSE
#| label: tbl-five
#| tbl-cap: "regression models for Spain and the Netherlands  - highway"
regression_highway_es <- lm(gini_n2 ~ I(KM/100000), data = merged_highway %>% filter(id_nuts0 == "ES"))
regression_highway_nl <- lm(gini_n2 ~ I(KM/100000), data = merged_highway %>% filter(id_nuts0 == "NL"))
huxreg(regression_highway_es, regression_highway_nl, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

comment on @tbl-five:

Spain (1):

For Spain, the results suggest a moderate positive relationship between the length of highways (in units of 100,000 kilometers) and regional inequality (Gini coefficient).
The p-value is 0.0386, which is less than the typical significance level of 0.05, indicating that highway length may have a significant impact on regional inequality.
The adjusted R-squared is 0.08889, implying that approximately 8.89% of the variation in the Gini coefficient can be explained by the variation in highway length.

Netherlands (2):

In contrast, for the Netherlands, the results show no significant relationship between highway length (in units of 100,000 kilometers) and regional inequality.
The p-value is 0.9213, which is higher than the usual significance level, suggesting that highway length does not have a significant impact on regional inequality.
The adjusted R-squared is -0.04947, indicating that highway length is not a good fit for the data.

**3.Model Interpretation:**

Based on the results from our three regression models for "New Firms," "Farm," and "Highway," it appears that none of these variables have a significant linear relationship with regional inequality (gini levels) in Spain and the Netherlands in 2010.
This implies that we cannot confirm our original hypothesis that an increase in the number of new startup firms, farm area, or highway length will have a substantial impact on regional inequality in the selected countries.
This indicates a need to explore other potential factors that may play a more significant role in explaining variations in gini levels in these countries.
Further research and the inclusion of additional relevant variables can contribute to a more comprehensive understanding of regional inequality.

In summary, the regression analyses for Spain, the Netherlands, and Greece have revealed varying relationships between certain factors and regional inequality.

Spain (ES):

The analysis found that the number of newly established companies ("newfirms") had no significant impact on regional inequality initially.
However, when population size was introduced as a control variable, a positive relationship emerged.
Larger populations were associated with lower regional inequality.
Additionally, the study identified a positive connection between the agricultural area ("farm") and regional inequality.
Lastly, the length of highways ("KM") was found to have a moderate positive relationship with regional inequality in Spain.

Netherlands (NL):

Similar to Spain, the Netherlands showed no significant relationship between newly established companies and regional inequality.
The inclusion of population as a control variable did not alter this result.
Moreover, neither agricultural area ("farm") nor highway length exhibited significant impacts on regional inequality in the Netherlands.

Greece (EL):

Unfortunately, due to missing data, the analysis for Greece provided limited insights.
It was not possible to determine the relationship between newly established companies, agricultural area ("farm"), or highway length and regional inequality in Greece.

These findings emphasize the diversity of factors influencing regional inequality in different countries.
While Spain exhibited significant associations between population, agricultural area, highway length, and regional inequality, the Netherlands did not show significant relationships with the selected variables.
Further investigations and data completeness are required for a comprehensive understanding of regional inequality dynamics in Greece.

# Assignment 3: Alternative Functional Forms and Panel Estimates

### Part A: Testing Development Effects Across Subsets

#### 1.Subset Analysis:

#### 2.Subset Analysis Discussion:

### Part B: Exploring alternative Functional forms

#### 1.Functional Form Exploration /2.Estimation and Visualization

Spredningsplott???

```{r}
#| echo: FALSE
#Making a correlation matrices for Spania
cor_matrix_spain <- cor(subset_data_es[, c("gini_n2", "GDP_per_capita")])

# Making a correlation matrices for Nederland
cor_matrix_netherlands <- cor(subset_data_nl[, c("gini_n2", "GDP_per_capita")])

#Making a correlation matrices for Hellas
cor_matrix_greece <- cor(subset_data_el[, c("gini_n2", "GDP_per_capita")])
```

Looking at the correlation between the Gini coefficient (gini_n2) and gross domestic product per capita (GDP per capita) in each of the countries (Spain, the Netherlands, and Greece) provides valuable insight into the relationship between economic inequality and economic prosperity in these regions.
In short, the analysis of the correlation provides valuable insights that can guide decision-makers, politicians and organizations in the design of targeted measures to deal with economic inequality.

```{r}
#| echo: FALSE
print("Correlation matrices for Spania")
print(cor_matrix_spain)

print("Correlation matrices for the Netherlands")
print(cor_matrix_netherlands)

print("Correlation matrices for Greece")
print(cor_matrix_greece)
```

Spain:

The correlation between the Gini coefficient (gini_n2) and GDP per capita is -0.2505.
This correlation is negative, suggesting a weak negative relationship between income inequality (measured by the Gini coefficient) and GDP per capita in Spain.
In other words, as income inequality increases, GDP per capita may potentially decrease, although the correlation is weak.

Netherlands:

The correlation between the Gini coefficient (gini_n2) and GDP per capita is -0.5774.
This correlation is also negative, and in this case, it is relatively strong.
It indicates a significant negative relationship between income inequality and GDP per capita in the Netherlands.
As income inequality increases, GDP per capita is expected to decrease.

Greece:

The correlation between the Gini coefficient (gini_n2) and GDP per capita in Greece is 0.6859.
This correlation is positive, and it is quite strong.
It suggests a significant positive relationship between income inequality and GDP per capita in Greece.
As income inequality increases, GDP per capita is expected to increase.

Further in the assignment, we will choose alternative functional forms (logarithmic, quadratic, cubic).

A logarithmic form may be appropriate to model the relationship between income inequality (gini_n2) and gross domestic product per capita (GDP_per_capita) in Spain and the Netherlands.
This is because the correlations are very weak and negative.
A logarithmic form can help capture a potential non-linear relationship that may be hidden in the data.

A cubic form may be relevant to model the relationship in Greece, where the correlation is positive and relatively strong.
This may suggest a crooked relationship where an increase in income inequality can lead to a significant increase in gross domestic product per inhabitant, but there may be an upper limit to this increase.

**Logarithmic form:**

```{r}
#| echo: FALSE
# Convert the data to the logarithm for Spain
subset_data_es$log_gini_n2 <- log(subset_data_es$gini_n2)
subset_data_es$log_GDP_per_capita <- log(subset_data_es$GDP_per_capita)

# Convert the data to the logarithm for the Netherlands
subset_data_nl$log_gini_n2 <- log(subset_data_nl$gini_n2)
subset_data_nl$log_GDP_per_capita <- log(subset_data_nl$GDP_per_capita)
```

```{r}
#| echo: FALSE
# Remove "-Inf" values from log_gini_n2 for Spain
subset_data_es <- subset_data_es[!is.infinite(subset_data_es$log_gini_n2), ]

# Remove "-Inf" values from log_gini_n2 for the Netherlands
subset_data_nl <- subset_data_nl[!is.infinite(subset_data_nl$log_gini_n2), ]
```

```{r}
#| echo: FALSE
# Fit linear regression for Spain
lm_model_spain <- lm(log_GDP_per_capita ~ log_gini_n2, data = subset_data_es)

# Fit linear regression for the Netherlands
lm_model_netherlands <- lm(log_GDP_per_capita ~ log_gini_n2, data = subset_data_nl)
```

```{r}
#| echo: FALSE
print("LM for Spania")
print(lm_model_spain)

print("LM for the Netherlands")
print(lm_model_netherlands)
```

Result for Spain (LM for Spain):

The regression model for Spain is given as: \`log_GDP_per_capita = 9.9493 - 0.0022 \* log_gini_n2\`.
The coefficient for \`log_gini_n2\` is negative (-0.0022), suggesting that an increase in income inequality is associated with a decrease in GDP per capita in Spain.

Result for the Netherlands (LM for the Netherlands):

The regression model for the Netherlands is given as: \`log_GDP_per_capita = 9.8536 - 0.1485 \* log_gini_n2\`.
The coefficient for \`log_gini_n2\` is also negative (-0.1485), indicating that an increase in income inequality is linked to a decrease in GDP per capita in the Netherlands.

```{r}
#| echo: FALSE
# Regression coefficients for Spain
a_spain <- coef(lm_model_spain)["log_gini_n2"]
b_spain <- coef(lm_model_spain)["(Intercept)"]

# Regression coefficients for the Netherlands
a_netherlands <- coef(lm_model_netherlands)["log_gini_n2"]
b_netherlands <- coef(lm_model_netherlands)["(Intercept)"]
```

```{r}
#| echo: FALSE
# Print regression coefficients for Spain
print("Regresjonskoeffisienter for Spani")
print(paste("a_spain:", a_spain))
print(paste("b_spain:", b_spain))

# Print regression coefficients for the Netherlands
print("Regresjonskoeffisienter for Nederland")
print(paste("a_netherlands:", a_netherlands))
print(paste("b_netherlands:", b_netherlands))

```

For Spain:

The coefficient \`a_spain\` is approximately -0.0022.
This represents the change in the logarithm of GDP per capita for each unit increase in the logarithm of income inequality.
With a negative coefficient, this indicates a negative relationship, meaning that an increase in income inequality is associated with a decrease in GDP per capita.The coefficient \`b_spain\` is approximately 9.9493.
This is the intercept value and represents the expected logarithm of GDP per capita when the logarithm of income inequality is 0.

For the Netherlands:

The coefficient \`a_netherlands\` is approximately -0.1485.
This also represents the change in the logarithm of GDP per capita for each unit increase in the logarithm of income inequality.
Similar to Spain, this negative coefficient indicates a negative relationship, meaning that an increase in income inequality is associated with a decrease in GDP per capita.

The coefficient \`b_netherlands\` is approximately 9.8536.
This is the intercept value and represents the expected logarithm of GDP per capita when the logarithm of income inequality is 0.

In summary, the results indicate a negative relationship between income inequality (measured by \`log_gini_n2\`) and GDP per capita (measured by \`log_GDP_per_capita\`) in both Spain and the Netherlands.
This means that in both countries, as income inequality increases (higher values of \`log_gini_n2\`), a decrease in GDP per capita (lower values of \`log_GDP_per_capita\`) is expected.
The coefficients also provide insight into the strength of this relationship, as the size of the coefficient indicates the degree of change in the response variable for each unit change in the independent variable.

Cubic shape:

```{r}
#| echo: FALSE
# Create logarithmically transformed columns for Greece
subset_data_el$log_gini_n2 <- log(subset_data_el$gini_n2)
subset_data_el$log_GDP_per_capita <- log(subset_data_el$GDP_per_capita)
```

```{r}
#| echo: FALSE
# Fit cubic regression for Greece
lm_model_greece_cubic <- lm(log_GDP_per_capita ~ log_gini_n2 + I(log_gini_n2^2) + I(log_gini_n2^3), data = subset_data_el)
```

```{r}
#| echo: FALSE
print(lm_model_greece_cubic)
```

Intercept (Constant): The intercept value is approximately 16.2524.
It represents the expected logarithm of GDP per capita when the logarithm of income inequality (\`log_gini_n2\`) and its squared and cubic values are all zero.

log_gini_n2 (Linear Coefficient):The coefficient for \`log_gini_n2\` is approximately 5.3217.
This represents the change in the logarithm of GDP per capita for each unit increase in the logarithm of income inequality.
A positive coefficient indicates a positive relationship.

I(log_gini_n2\^2) (Quadratic Coefficient): The coefficient for the square of \`log_gini_n2\` is approximately 1.4039.
It represents the change in the logarithm of GDP per capita for each unit increase in the square of the logarithm of income inequality.
This coefficient provides information about the shape of the cubic relationship.

I(log_gini_n2\^3) (Cubic Coefficient):The coefficient for the cube of \`log_gini_n2\` is approximately 0.1208.
It represents the change in the logarithm of GDP per capita for each unit increase in the cube of the logarithm of income inequality.
This coefficient further informs about the shape of the cubic relationship.

Overall, these coefficients indicate a complex cubic relationship between income inequality and GDP per capita in Greece.
They provide insights into the direction and strength of the relationship, as well as how this relationship changes with different powers of income inequality.

```{r}
#| echo: FALSE
# Regression coefficients for Greece (cubic)
coefficients_greece_cubic <- coef(lm_model_greece_cubic)
```

```{r}
#| echo: FALSE
# Display the coefficients for the cubic regression
coefficients_greece_cubic
```

Intercept (Constant):The intercept value is approximately 16.2524.
It represents the expected logarithm of GDP per capita when the logarithm of income inequality (\`log_gini_n2\`) and its squared and cubic values are all zero.

log_gini_n2 (Linear Coefficient):The coefficient for \`log_gini_n2\` is approximately 5.3217.
This represents the change in the logarithm of GDP per capita for each unit increase in the logarithm of income inequality.
A positive coefficient indicates a positive relationship.

I(log_gini_n2\^2) (Quadratic Coefficient):The coefficient for the square of \`log_gini_n2\` is approximately 1.4039.
It represents the change in the logarithm of GDP per capita for each unit increase in the square of the logarithm of income inequality.
This coefficient provides information about the shape of the cubic relationship.

I(log_gini_n2\^3) (Cubic Coefficient):The coefficient for the cube of \`log_gini_n2\` is approximately 0.1208.
It represents the change in the logarithm of GDP per capita for each unit increase in the cube of the logarithm of income inequality.
This coefficient further informs about the shape of the cubic relationship.

These coefficients describe the relationship between income inequality and GDP per capita in Greece within the context of a cubic function, with the intercept and various powers of \`log_gini_n2\` influencing the outcome.

#### 3.Results Interpretation

**The original linear model:**

As we have not previously created a combined regression model for all countries from 2010 in the task, we do so here, allowing us to compare it to the original linear model.

```{r}
#| echo: FALSE
# Perform regression on the combined dataset
regression_model_all_countries <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data_2010)
```

```{r}
#| echo: FALSE
#| label: tbl-original_linear
#| tbl-cap: "original linear model"
# Display regression results using huxreg
huxreg(regression_model_all_countries, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

Comment on the @tbl-original :

The linear regression model for the relationship between GDP_per_capita/10000 and gini_n2 is statistically significant.
The intercept, representing the estimated gini_n2 when GDP_per_capita/10000 is zero, is 0.103440.
The coefficient for GDP_per_capita/10000 is -0.023270, indicating that for each unit increase in GDP_per_capita/10000, the estimated gini_n2 decreases by approximately 0.023270.

Both the intercept and the coefficient are highly significant (indicated by \`\*\*\*\` in the output), suggesting a strong statistical relationship.
The residual standard error is 0.05272, reflecting the variability of observed \`gini_n2\` values around the model's predictions.
The model explains approximately 14.47% of the variability in gini_n2 as indicated by the Multiple R-squared.
The Adjusted R-squared (0.1289) considers the model's complexity.

The F-statistic tests the overall significance of the model, and its associated p-value (0.003824) is below the conventional significance level, indicating that the model is statistically significant as a whole.

Our conclusion is that the linear regression model provides evidence of a statistically significant negative relationship between GDP_per_capita/10000 and gini_n2.
However, it's important to note that the model explains a relatively modest proportion of the variability in gini_n2.

**Comparison/Summarizing**:

Our analysis focused on regression models examining the relationship between income inequality and GDP per capita across several countries, including Spain, the Netherlands, Greece, Poland, and Slovenia.
The objective was to evaluate and compare alternative models to the original linear model, aiming for a comprehensive understanding of economic relationships across diverse nations.

In the original linear model, a negative correlation was observed between GDP per capita and income inequality, with a coefficient of -0.023270.
This suggests that an increase in GDP per capita is expected to reduce income inequality.

Alternative models included logarithmic transformations for Spain and the Netherlands, as well as a cubic model for Greece.
Logarithmic models provide a percentage interpretation of coefficients, while cubic models offer a more complex representation of the relationship between income inequality and GDP per capita.

Results from the logarithmic models for Spain and the Netherlands suggest a diminishing effect of GDP per capita on income inequality with economic growth.
This could be interpreted as economic gains having a relatively greater impact on income inequality in low-income economies compared to high-income ones.

In the cubic model for Greece, the cubic terms indicate a more intricate relationship, possibly suggesting critical points or curvatures in the relationship between income inequality and GDP per capita.

### Part C: Heteroskedasticity Testing and Causality Discussion

#### 1.Heteroskedasticity Testing:

```{r}
#| echo: FALSE
#Getting the residual from models
residuals_original <- resid(regression_model_all_countries)

#Performing the Breusch-Pagan test
hetero_test_original <- bptest(regression_model_all_countries)
```

```{r}
#| echo: FALSE
#| label: tbl-hetroOriginal
#| tbl-cap: "Hetroskedasticity test for the original model"
print(hetero_test_original)
```

Comment on the @tbl-hetroOriginal

Statistical Significance (p-value):The p-value of 0.1816 is greater than common significance levels like 0.05.
This suggests that we do not have sufficient evidence to reject the null hypothesis of homoskedasticity.
In other words, there is no statistically significant evidence of heteroskedasticity in the original linear model for all countries based on the Breusch-Pagan test.

Conclusion: Given these results, we cannot conclude that there is heteroskedasticity in the original linear model for all countries.
The model appears to handle the variation in errors uniformly across all observations.

If the p-value had been lower (typically below 0.05), it would have indicated evidence of heteroskedasticity.
In such cases, a more appropriate model might include corrections, such as robust standard errors, to address potential heteroskedasticity.

```{r}
#| echo: FALSE
#Getting the residuals from the alternative model
residuals_alternative_S <- resid(lm_model_spain)

#Performing the Breusch-Pagan test
hetero_test_spain <- bptest(lm_model_spain)
```

```{r}
#| echo: FALSE
#Getting the residuals from the alternative model
residuals_alternative_N <- resid(lm_model_netherlands)

#Performing the Breusch-Pagan test
hetero_test_netherlands <- bptest(lm_model_netherlands)
```

```{r}
#| echo: FALSE
#Getting the residuals from the alternative model
residuals_alternative_G <- resid(lm_model_greece_cubic)

#Performing the Breusch-Pagan test
hetero_test_greece <- bptest(lm_model_greece_cubic)
```

```{r}
#| echo: FALSE
#| label: tbl-hetroESG
#| tbl-cap: "Hetroskedasticity test for Spaint, Nederlands and Greece"
print(hetero_test_spain)
print(hetero_test_netherlands)
print(hetero_test_greece)
```

Comment on the @tbl-hetroESG

Spain: The p-value of 0.6383 is larger than common significance levels (e.g., 0.05), suggesting that there is no significant evidence of heteroskedasticity in the model for Spain.
The model appears to handle the variation in errors effectively, showing homoskedasticity.

The Netherlands: Similar to the case of Spain, the p-value of 0.3173 is greater than conventional significance levels, indicating no significant evidence of heteroskedasticity in the model for the Netherlands.
The model seems to account for error variance consistently across observations.

Greece: For the cubic model in Greece, the p-value of 0.3461 is higher than common significance levels.
This suggests that there is no significant evidence of heteroskedasticity in the cubic model for Greece.
The model handles the variance in errors effectively.

Based on the results of the Breusch-Pagan tests for both the original model and the alternative models, it seems that none of the models provide strong evidence of heteroskedasticity.
The p-values are all relatively high, not providing sufficient grounds to reject the null hypothesis of homoskedasticity.

#### 

2.Causality Discussion:

As we can observe, neither the original model nor the alternative models show strong evidence of heteroskedasticity.
There are several strategies one can employ to induce evidence of heteroskedasticity in the models.
To manipulate the error term by adding extreme values for specific observations or by introducing exponential growth can be strategies to generate heteroskedasticity in the models.

Adding Extreme Values:

By introducing extreme values to the error term for selected observations, you create variation in the error term that may manifest as heteroskedasticity.
This can be achieved by identifying specific data points that experience a significant increase in the variance of the error term.

Exponential Growth in the Error Term:

Introducing exponential growth in the error term as a function of one or more independent variables will also lead to increasing variance.
This can mimic situations where the uncertainty in observations grows exponentially with changes in the independent variables.

### Part D: Panel Estimates

#### 1.Panel Estimation Task:

```{r}
#| echo: FALSE
# Corrected dataset
Panel_Data <- data_2010 %>%
  distinct(year, geo, id_nuts0, id_nuts2, GDP_per_capita, population, gini_n2) %>%
  mutate(GDP_per_capita = GDP_per_capita) %>%
  mutate(gini_nuts3 = gini_n2 * 100000) %>%
  select(year, geo, id_nuts0, id_nuts2, population, GDP_per_capita, gini_n2, gini_nuts3)

```

```{r}
#| echo: FALSE
# Model 1: Estimate the effect at NUTS level with several indices
plm1 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("year", "geo"), model = "within") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)

```

```{r}
#| echo: FALSE
# Model 2: Estimate the effect at Year level
plm2 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("year"), model = "within", effect = "individual") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)
```

```{r}
#| echo: FALSE
# Model 3: Estimate the effect at NUTS2 level
plm3 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("id_nuts0"), model = "within") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)
```

```{r}
#| echo: FALSE
#| label: tbl-six
#| tbl-cap: "panel estimation"
# Assume you have plm models defined as plm1, plm2, plm3, plm4

huxreg(
  list(
    "Fixed effect Country" = plm1,
    "Fixed effect Year" = plm2,
    "Fixed effect NUTS2" = plm3
  ),
  statistics = c(N = "nobs", R2 = "r.squared", FStat = "statistic", PValue = "p.value"),
  stars = c("*" = 0.1, "**" = 0.05, "***" = 0.01),
  note = "Note): {stars} T statistics in brackets."
)
```

comment on @tbl-six

In the fixed-effects model, the variables country, year, and NUTS2 are considered fixed and not random or mixed.
From the results presented in our table (similar to \@tbl-25), we observe that we have 56 observations for each fixed effect.
None of the correlations among the fixed effects are notably high, indicating that they do not explain a substantial proportion of the variation in the dependent variable attributable to the independent variable.

The only fixed effect that appears to exhibit some level of correlation is the fixed effect associated with the variable "year." This fixed effect has an R-squared value of 0.145, suggesting that approximately 14.5% of the variation in the dependent variable is explained by the fixed effect on the variable "year." The p-value associated with this correlation is less than 0.01, indicating that the correlation is statistically significant.

In summary, the fixed-effects model reveals that the fixed effects for country and NUTS2 do not show notable correlations with the dependent variable.
However, the fixed effect on the variable "year" demonstrates a statistically significant correlation, explaining a moderate but meaningful proportion of the variation in the dependent variable.
Again, I apologize for any confusion, and thank you for bringing it to my attention.

## References
