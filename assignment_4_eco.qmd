---
title: "Econometrics Assignement 2023"
editor: visual
author: "Ingrid Strømme & Emilie Sørhaug"
format: 
 pdf:
  papersize: a4
bibliography: references.bib
---

```{r}
#| label: setup
#| message: false
#| output: false
#| echo: FALSE
library(tidyverse)
library(dplyr)
library(dineq)
library(ineq)
library(magrittr)
library(huxtable)
library(broom)
library(readr)
library(lmtest)
library(plm)
```

## Eurostat EDA

### Introduction

In this paper, we aim to conduct an explanatory data analysis of various statistics for a diverse set of European countries.
Our focus will be on exploring sub-national GDP and regional inequities within the chosen nations.
The countries under examination include Ireland (IE), Poland (PL), Spain (ES), Slovenia (SI), Netherlands (NL), Greece (GR), Norway (NO), and Albania (AL).

In our first part of this paper, the focus is on dissecting subnational Gross Domestic Product (GDP) and GDP per capita.
Our objectives were clear: understand the patterns of economic performance at the regional level and delve into the intricacies of regional inequality.
By calculating the Gini coefficient, we sought to quantify and interpret the disparities within each country, laying the groundwork for a nuanced understanding of economic heterogeneity.

Further in the paper, zooming in on the pivotal year 2010, our second assignment delved into the dynamics of economic growth and inequality.
Going beyond mere observation, we introduced additional determinants---variables such as farm, innovation (new firms), and highway---aiming to unravel the complex factors influencing economic trajectories during this specific period.
The research questions probed into growth and inequality trends and dissected the contributions of these variables to the broader economic landscape.

Finally, we delved into development effects across subgroups, scrutinized alternative functional forms, and navigated methodological challenges like heteroskedasticity and causality.
The culmination of our journey was the application of panel estimates, allowing us to capture and comprehend the intricate time-series variations in the data.

### Sub-national GDP and GDP per Capita

To commence our analysis of sub-national GDP and regional inequality for the selected countries, we, as previously mentioned, collect data from Eurostat.
We download population data categorized by broad age groups and gender, along with gross domestic product at current market prices, specifically at the NUTS 3 level @zotero-124 @zotero-126 .
NUTS (Nomenclature of territorial units for statistics) encompasses three levels---NUTS 1, NUTS 2, and NUTS 3, with the latter providing a detailed sub-regional perspective @zotero-165 .
The data is from 2000-2020.

Once we incorporate these two datasets into our RStudio project, we proceed to calculate GDP per capita at the NUTS 3 level for the individual countries.
This calculation is achieved by dividing GDP by the population figure, and it can be expressed using the following formula:

$$
y_i=GDP_i/population_i
$$

It is interesting to explore the figures for GDP per capita in different regions to gain insights into economic disparities and dynamics within each country.
Its reason to believe that high population equals high GDP based on the fact that it is more people that contributes to the GDP.
However, this can not be applied in every circumstances @zotero-167 .
@tbl-one provides an overview of the mean, variance, maximum, and minimum values for GDP per capita in selected European countries.

![](images/Skjermbilde%202023-12-07%20kl.%2009.31.37.png){fig-align="center" width="268"}

Albania exhibits a relatively modest mean GDP, with considerable variance.
The maximum and minimum GDP values suggest a range reflecting the economic diversity within the country.
Greece demonstrates a higher mean GDP compared to Albania, but the substantial variance indicates notable economic disparities.
The range from minimum to maximum GDP underscores the economic heterogeneity.
Spain exhibits a higher mean GDP, indicating a more robust economic performance.
However, the variance suggests variations in economic output across different regions or time periods.
Ireland stands out with a significantly higher mean GDP, but the considerable variance and a wide range between maximum and minimum GDP values indicate potential economic volatility.

The Netherlands shows a robust mean GDP, and while there is variance, the range between maximum and minimum GDP is relatively moderate.
Norway boasts the highest mean GDP in the dataset.
The variance and range suggest a stable but comparatively concentrated economic landscape.
Poland's mean GDP is lower, and there is considerable variance, reflecting economic diversity.
The range between maximum and minimum GDP values underscores the disparities within the country.
Slovenia shows a moderate mean GDP, with variance indicating economic variations.
The range between maximum and minimum GDP values highlights regional economic differences.

It may be good to note that Ireland (IE) and Norway (NO) have the highest mean, while Albania (AL) and Poland (PO) have the lowest.
We also see an extremely high range between min. and max.
values in Ireland (IE).

We also had some NA values witch we chose to take out of the dataset.
NA values may come from the fact that Population or the GDP was not measured this year or was not available when the dataset was made.

### Regional Inequity

Regional inequity encompasses the uneven distribution and disparities in the quality of life, wealth, and overall living standards among individuals within a specific region.
In our analysis of regional inequity for the chosen countries, we employ the population-weighted GDP Gini coefficients.
These coefficients are numerical measures that can range from 0 to 1.
@zotero-120 .A value of 0 indicates no inequity, while higher values signify increased levels of inequity within the country or region.
The upper limit of 1 corresponds to absolute inequity.
The calculation of these coefficients follows the formula:

$$
GINIW_j=\frac{1}{2 \bar{y_j}} \sum_{i}^{n_j}\sum_{l}^{n_j}\frac{p_i}{P_j} \frac{p_l}{P_j} |y_i-y_l|
$$

The first thing we would like to comment on is that there are no gini values for Norway.
This is because there are missing data for Norway in both data sets from Eurostat.
We therefore do not want to include Norway further in the rescues as this gives us incomplete data.

As we can see from @fig-one a plot of all the countries we have been tasked to analyze, we see that there are two regions from Ireland that have the highest Gini values, which are 0.249 and 0.245.
Furthermore, there are a couple of regions in the Netherlands that have a Gini value from 0.224-0.241.

We also wanted to make a plot only including Spain and Poland, @fig-two, in the plot.
This is because these countries have the most observations, and therefore give a more realistic picture of the countries.
Ireland, for example, deals with 3 regions where one region has quite a lot of development, but this gives us little insight into how the rest of the country's values are.

![](images/Skjermbilde%202023-12-07%20kl.%2009.34.05.png){fig-align="center" width="596"}

What is similar about both Spain and Poland is that there is a big jump in the Gini value between the lowest and the highest region.
There are three of the regions in Poland that stand out a little as they have no data observations from 2000 to 2009 and 2014.

The observed variation in income inequality between regions in the assigned countries is of great importance.
It emphasizes the need for targeted, region-specific interventions to address and alleviate inequalities in income distribution and promote economic justice at the local level.
These variations in Gini coefficients indicate that a one-size-fits-all approach to economic policy may not be effective, as the factors driving income inequality may vary significantly between regions.

### Conclusion

In the initial part of our study, we analyzed subnational Gross Domestic Product (GDP) and GDP per capita, aiming to understand economic patterns and regional inequalities.
Using the Gini coefficient, we quantified disparities within each country.
Data from Eurostat (2000-2020) revealed significant variations in GDP per capita, with Ireland having the highest average and Albania the lowest.
Notably, Norway had no Gini values due to missing data.

Regional inequity analysis highlighted pronounced income inequality in Ireland and the Netherlands.
Focused assessments on Spain and Poland showcased substantial variations in Gini values between regions.
This underscores the need for tailored, region-specific interventions to address income inequality, recognizing diverse factors influencing economic disparities.

### Growth and inequity

In the second part of this paper, we will delve into the exploration of growth and inequity within our selected subset of countries.
This section we will carry out a simple regression model and explore the effect of regional economic development $y_j$ on regional inequality $GINIW_j$.
We will do this in order to gain an understanding of the connection between economic growth indicators such as GDP per capita and inequality might have.
We will explore if higher GDP per capita may lead to less or greater inequality, and also gain an understanding to what extent these variables are related.
Later in this segment, we will proceed to estimate a multiple linear regression model incorporating additional variables that may contribute to inequity, details of which will be elucidated subsequently.
For the sake of simplicity, our focus in these analyses will be confined to the year 2010.

The simple regression model for this part is structured in the following way:

$$
Y_i = β_1 + β_2X_i + ε_i
$$

-   $Y_i$ as the dependent/ explained variable

-   $X_i$ as the independent/ explanatory variable

-   $β_1$ as the intercept/ constant

-   $β_2$ as the slope coefficient

-   $ε_i$ as the error/ disturbance term

Dependent variable (Regional inequality - Gini coefficient): We have chosen the Gini coefficient as a measure of regional inequality, as it gives a quantitative indication of the distribution of income/wealth within a region.
Higher Gini coefficient indicates greater inequality.

Independent variable (Regional development - GDP per capita): We have chosen GDP per capita as the measure of regional development, as it represents the economic performance per inhabitant and can indicate the level of prosperity in a region.

One theory we have is that when a country's Gross Domestic Product (GDP) per capita increases, there is a corresponding decrease in the Gini coefficient, suggesting that higher economic development is associated with reduced income inequality.Economic growth is often associated with a decrease in income inequality.
As a country's economy expands and its Gross Domestic Product (GDP) per capita increases, more opportunities for employment, better access to education, and investments in public services become possible.
This can lead to an improvement in living standards and a more equal distribution of income among the population.

### The effect of regional economic development on regional inequality:

We will carry out a model estimate with regional development $y_j$ as the independent variable and regional inequality $GINIW_j$ as dependent variable, as we mentioned.
@tbl-four is a linear regression analysis to assess the relationship between regional development and regional inequality for our countries.
Due to missing data from 2010 in some countries, we only have the following countries Spain, Poland, the Netherlands, Slovenia and Greece.

The linear regression model in @tbl-four indicates a strong and statistically significant relationship (\*\*\*), denoted by the high level of significance, between regional economic development (measured by GDP per capita scaled by 10,000) and regional inequality (Gini coefficient) for the NUTS2 regions of our selected countries.
The intercept of 0.103440 represents the estimated Gini coefficient when the regional GDP per capita is zero, although this scenario is not practically meaningful in the context of our study.

![](bilde.png){fig-align="center" width="281"}

The negative coefficient for GDP per capita (-0.023270) implies that, on average, an increase in regional economic development by one unit (scaled by 10,000) is associated with an approximate 0.023270 decrease in the estimated Gini coefficient.
In simpler terms, regions with higher GDP per capita tend to exhibit lower levels of income inequality.
The significance of both the intercept and coefficient, indicated by \*\*\*, underscores the reliability and robustness of this observed statistical relationship.

The model's residual standard error of 0.05272 quantifies the average amount by which the observed Gini coefficients deviate from the values predicted by the model.
The Multiple R-squared of 14.47% indicates that the model explains this percentage of the variability in the Gini coefficient.
The Adjusted R-squared, which considers the number of predictors in the model, is 0.1289, providing a more conservative estimate of explanatory power.

Despite the statistical significance, it's important to acknowledge that the model accounts for only a modest portion of the total variability in the Gini coefficient.
This limitation could be attributed to the complex and multifaceted nature of regional inequality, influenced by factors beyond the scope of the current model.
These unaccounted factors may include social structures, educational disparities, employment patterns, and other economic variables that contribute to regional income inequality.
Therefore, while the observed negative association is statistically robust, the model's ability to explain the entirety of Gini coefficient variation is constrained by the intricacies of regional economic dynamics.

We want to look at each country separately in the regression analysis.
It helps us understand specific factors and variations in different countries.
This approach simplifies dealing with issues such as differences in data patterns and non-linearities unique to each country.
By analyzing countries individually, we can gain more accurate insights and make meaningful comparisons.
From @tbl-five

![](393087792_1400964130854273_3106895822851110905_n.png){fig-align="center"}

we can read from each country:

**Results for ES in 2010 - Model (1)**

In the linear regression for Spain (ES) in 2010, a significant p-value of 0.301 was observed for GDP per capita, with an R-squared value of 0.063.
This indicates that there is no significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient) in Spain in 2010.
The low R-squared value suggests that only 6.3% of the variation in the Gini coefficient can be explained by the variability in GDP per capita.

In the linear regression for Spain (ES) in 2010, we observed the following results: The Intercept was 0.039, and for GDP per capita (Beta for GDP per capita), the value was -0.010.
This indicates a negative relationship between GDP per capita and the Gini index in Spain.
In other words, as GDP per capita increases, the Gini index decreases.

The model for Spain has a low R-squared value, indicating that the GDP_per_capita variable does not explain much of the variation in gini_n2.
The p-value for the coefficient of GDP_per_capita is also relatively high, suggesting that it may not be statistically significant.

**Results for PL in 2010 - Model (2)**

For Poland (PL) in 2010, the p-value for GDP per capita was 0.572, and the R-squared value was 0.037.
This again indicates no significant relationship between economic development and regional inequality for Poland in 2010.
The high p-value and low R-squared value suggest a weak explanation of the Gini coefficient based on GDP per capita.

In the case of Poland (PL) in 2010, the results were as follows: The Intercept was 0.139, and for GDP per capita (Beta for GDP per capita), the value was -0.021.
This means there is also a negative relationship between GDP per capita and the Gini index in Poland.
An increase in GDP per capita reduces the Gini index.

The model for Poland has a very low R-squared and a negative adjusted R-squared, indicating that the GDP_per_capita variable does not provide a good fit to the data.
The p-value for the coefficient of GDP_per_capita is high, suggesting it is not statistically significant.

**Results for NL in 2010 - Model (3)**

Netherlands (NL) in 2010 exhibited a p-value of 0.063 for GDP per capita and an R-squared value of 0.333.
This suggests a moderate relationship between economic development and regional inequality for the Netherlands in 2010.
The relatively low p-value and moderate R-squared value imply that some of the variation in the Gini coefficient can be explained by the variation in GDP per capita.

Looking at the Netherlands (NL) in 2010, the results were as follows: The Intercept was 0.167, and for GDP per capita (Beta for GDP per capita), the value was -0.037.
Again, this indicates a negative relationship between GDP per capita and the Gini index in the Netherlands.
An increase in GDP per capita reduces the Gini index.

The model for the Netherlands has a moderate R-squared value, indicating that GDP_per_capita has some explanatory power, though it is not very high.
The p-value for GDP_per_capita suggests it might be marginally significant.

**Results for SI in 2010 - Model (4)**

Results for Slovenia (SI) in 2010 are unusual.
There is a regression error due to the absence of residual degrees of freedom, indicating insufficient variation in the data to perform a meaningful regression.
These results should not be interpreted due to this error.

The model for Slovenia has a perfect R-squared of 1, but it also indicates there are no degrees of freedom, suggesting a problem with the model.
This could be due to a very small sample size.

**Results for EL in 2010 - Model (5)**

Greece (EL) in 2010 displayed a significant relationship between economic development (GDP per capita) and regional inequality (Gini coefficient).
The p-value was 0.010, and the R-squared value was 0.470.
This indicates that an increase in GDP per capita is associated with a significant increase in the Gini coefficient for Greece in 2010.

For Greece (EL) in 2010, the following findings were made: The Intercept was -0.026 and for GDP per capita (Beta for GDP per capita), the value was 0.048.
This suggests a positive relationship between GDP per capita and the Gini index for Greece.
An increase in GDP per capita leads to an increase in the Gini index.

The model for Greece has a relatively high R-squared, indicating that the GDP_per_capita variable explains a substantial portion of the variation in gini_n2.
The p-value for GDP_per_capita is low, suggesting it is statistically significant.

Overall, the findings show that the relationship between economic development and regional inequality varies significantly between countries in 2010.
While some countries do not show significant relationships, others indicate a more significant influence of economic development on regional inequality.
It is important to take these findings into account when designing policies to address regional disparities and promote sustainable economic growth.
Today's complex economic landscape underscores the need for continuous analysis and adaptation of policies to address the dynamics of regional inequality.

Furthermore, in the thesis we want to include **Spain**, **Greece** and **the Netherlands**.
Will choose to include Spain (ES) and the Netherlands (NL), even though they showed that the connections between GDP per capita and the Gini coefficient are often not very strong.
This is because they still have lower p-values and higher R-squared values compared to the other countries.
This indicates that there is a certain degree of explanatory power in these two models, although the connections may not be very strong.

In the case of Greece (EL), the results actually show a significant positive correlation between regional inequality (Gini coefficient) and economic development (GDP per capita).
This indicates that the increase in GDP per capita is associated with a significant increase in the Gini coefficient for Greece in 2010.
Therefore, Greece will be an important country to include in our further analysis and discussion in the thesis.
It is particularly important to look for positive correlations between economic development and regional inequality.

Following @fig-es and @fig-nl: both Spain and the Netherlands have a downward slope, the Netherlands a steeper slope than Spain.
If we look at @fig-el , Greece, on the other hand, we see that the line is going up.
This supports our results from the regression model with that Greece shows a significant positive correlation between regional inequality (Gini coefficient) and economic development (GDP per capita).

![](images/Skjermbilde%202023-12-07%20kl.%2009.41.00.png){fig-align="center" width="481"}

![](images/Skjermbilde%202023-12-07%20kl.%2009.41.45.png){fig-align="center" width="490"}

![](images/Skjermbilde%202023-12-07%20kl.%2009.42.30.png){fig-align="center" width="518"}

\clearpage

### Classical assumptions OLS

Classical Assumptions of Ordinary Least Squares (OLS)

Statistical methods, such as ordinary least squares regression (OLS), rely on a set of underlying assumptions for optimal performance.
The accuracy of OLS estimates is contingent on the satisfaction of these classical assumptions.
There exist six fundamental assumptions for OLS regression, and the fulfillment of the initial four ensures unbiased models.
The following outlines all six assumptions: @zotero-169

1.  **Linearity:** A linear relationship must exist between the dependent variable (\$Y_i\$) and the independent variable (\$X_i\$).
    Examination of scatter plots with fitted lines reveals an attempt to capture the relationship adequately.
    Notably, the scatter plot indicates variation in the relationship between GINI and GDP per capita, with some outliers exhibiting significantly higher standard errors than the rest of the dataset.

2.  **Sample Variation:** Considerable variation should be present in the independent variable (\$X_i\$).

3.  **Random Sampling:** The data is obtained through random sampling from the population of interest.
    Eurostat, our data source, is deemed reliable for random sampling.
    To enhance data quality, we excluded NA values and countries not pertinent to our dataset.
    Additionally, certain observations were omitted for countries with an extensive dataset.

4.  **Exogeneity:** The explanatory variable (\$X_i\$) remains exogenous, indicating no influence from other variables in the explanatory model.
    In our context, GDP per capita is unaffected and acts as the influencing variable.

5.  **Homoskedasticity:** The error term (\$ε_i\$) is expected to have uniform variance for each value of the independent variable (\$X_i\$).
    However, visual inspection of the scatter plot suggests that the error term does not exhibit the uniform variance stipulated by this assumption.

6.  **Normality:** The population error term (\$ε_i\$) should follow a normal distribution.
    In our dataset, the error term does not equal zero, rendering this assumption unmet.

It is crucial to recognize that the adherence to these assumptions enhances the reliability of OLS regression models.
However, discrepancies observed in our dataset highlight the need for cautious interpretation and potential consideration of alternative models or robust techniques.
@zotero-169

### Other determinants of inequity

Futhermore, we want to explore other determinants of inequity.
It will be important to explore alternative variables that can potentially influence and be linked to regional inequality.
We have chosen to add three data sets that we will use as variables into our subset data to see what impact innovation, farms and highways have on regional inequality.
@zotero-124 @zotero-126 @zotero-148 The analysis will be delimited by the fact we are only exploring the year of 2010, as mentioned previously.

We hypothesize that the number of newly established companies, farm area, and the length of highways in a region have a significant impact on regional inequality in Spain, the Netherlands, and Greece.
More specifically, we expect that an increase in the number of newly established companies and farm area in the region will be associated with a reduction in regional inequality, while an increase in the length of highways may also impact regional inequality.
We will conduct analyses to test this hypothesis using statistical methods to assess whether the variables indeed have a significant effect on regional inequality in the three countries.

The one data set we have chosen to include as a variable does not have data from Greece, so we will only get figures for Spain and the Netherlands when we look at whether new firms have an impact on regional inequality.

In @tbl-six we have a linear regression analysis for Spain and the Netherlands revealed no significant linear relationship between the number of newly established companies (newfirms) and regional inequality (Gini coefficient).
In Spain, the p-value was 0.444, and the low R-squared value (0.03486) indicated limited explanatory power (3.486% variation explained).
Similarly, for the Netherlands, the p-value was 0.6316, with an R-squared value of 0.02663 (2.663% variation explained).
These findings suggest that the number of new firms alone is insufficient to explain regional inequality in both countries.

![](innovation.png){fig-align="center" width="312" height="319"}

To enhance the analysis, the variable "population" will be included as a control variable to better understand the relationship between new startup firms ("newfirms") and regional inequality ("gini_n2").
This addition aims to explore any connections that may arise due to regional population size, this we see in @tbl-innovationandpop

![](innovation%20and%20population.png){fig-align="center" width="312"}

For Spain (1) in 2010, the regression analysis reveals a significant positive correlation between the establishment of new businesses and regional inequality.
A higher number of new businesses corresponds to increased regional inequality.
In addition, larger populations are associated with lower regional inequality.
The model is statistically significant, and explains 27.35% of regional inequality variation.

In contrast, the Netherlands (2) in 2010 shows no significant impact of new business establishments or population size on regional inequality.
The model lacks statistical significance and explains only 1.621% of the variation in regional inequality.

A new regression model will be created to assess the effect of farms on regional inequality, now including Greece in the analysis.
@tbl-seven

![](farm.png){fig-align="center" width="352"}

For Spain in @tbl-seven , the results reveal a moderate positive relationship between agricultural area ("farm") and regional inequality (Gini coefficient), with a p-value of 0.0309, suggesting a significant impact.
The adjusted R-squared is 0.2014, indicating that 20.14% of the Gini coefficient variation can be explained by agricultural area.

In the Netherlands, there is no significant relationship between agricultural area and regional inequality, as indicated by a p-value of 0.532.
The adjusted R-squared is -0.06125, suggesting that agricultural area does not fit the data well.

Similarly, for Greece, there is no significant relationship between agricultural area and regional inequality, with a p-value of 0.283.
The adjusted R-squared is 0.2712, meaning 27.12% of the Gini coefficient variation can be explained by agricultural area.

A new regression analysis will be conducted @tbl-eight including the variable KM from the highway dataset, to explore its potential impact on regional inequalities in Spain and the Netherlands.
Note that Greece will not be included due to missing values in this dataset.

![](highway.png){fig-align="center" width="356"}

For Spain (1) @tbl-eight , the results indicate a moderate positive relationship between the length of highways (in units of 100,000 kilometers) and regional inequality (Gini coefficient), with a p-value of 0.0386, suggesting a potentially significant impact.
The adjusted R-squared is 0.08889, signifying that around 8.89% of the Gini coefficient variation can be explained by the variation in highway length.

Conversely, for the Netherlands (2), there is no significant relationship between highway length (in units of 100,000 kilometers) and regional inequality.
The p-value is 0.9213, higher than the usual significance level, indicating that highway length does not significantly impact regional inequality.
The adjusted R-squared is -0.04947, suggesting that highway length is not a good fit for the data.

Based on the results from our three multiple regression models, @tbl-six , @tbl-seven , @tbl-eight , for "New Firms," "Farm," and "Highway," these findings emphasize the diversity of factors influencing regional inequality in different countries.
While Spain exhibited significant associations between population, agricultural area, highway length, and regional inequality, the Netherlands did not show significant relationships with the selected variables.
Further investigations and data completeness are required for a comprehensive understanding of regional inequality dynamics in Greece.

Futhermore we have looked at the correlation between the Gini coefficient (gini_n2) and gross domestic product per capita (GDP per capita) in each of the countries (Spain, the Netherlands, and Greece).
This provides valuable insight into the relationship between economic inequality and economic prosperity in these regions.
In short, the analysis of the correlation provides valuable insights that can guide decision-makers, politicians and organizations in the design of targeted measures to deal with economic inequality.

### Alternative Functional Forms:

So now, we wanted to look at the correlation between the Gini coefficient (gini_n2) and gross domestic product per capita (GDP per capita) in @tbl-corr , for Spain, the Netherlands and Greece, as mention.
The results indicate the following:

![](images/Skjermbilde%202023-12-07%20kl.%2010.22.39.png){fig-align="center" width="344"}

1.  **Spain:** The correlation between the Gini coefficient and GDP per capita is -0.2505, suggesting a weak negative relationship.
    An increase in income inequality may potentially lead to a decrease in GDP per capita, although the correlation is weak.

2.  **Netherlands:** The correlation between the Gini coefficient and GDP per capita is -0.5774, indicating a relatively strong negative relationship.
    Increased income inequality is expected to lead to a decrease in GDP per capita in the Netherlands.

3.  **Greece:** The correlation between the Gini coefficient and GDP per capita in Greece is 0.6859, showing a strong positive relationship.
    An increase in income inequality is expected to lead to an increase in GDP per capita in Greece.

The analysis reveals significant variation in the relationship between economic inequality and prosperity across the examined countries.
These findings offer valuable guidance for decision-makers, policymakers, and organizations, emphasizing the need for tailored measures to address economic inequality in each region.

Understanding these correlations is essential for policymakers and organizations to formulate targeted strategies addressing economic inequality.
The correlations provide quantitative insights into how changes in income distribution may impact overall economic prosperity, helping guide effective decision-making and resource allocation.
@froslie2023

Further in the assignment, we will choose alternative functional forms (logarithmic, quadratic, cubic).

A logarithmic form may be appropriate to model the relationship between income inequality (gini_n2) and gross domestic product per capita (GDP_per_capita) in Spain and the Netherlands.
This is because the correlations are very weak and negative.
A logarithmic form can help capture a potential non-linear relationship that may be hidden in the data.

A cubic form may be relevant to model the relationship in Greece, where the correlation is positive and relatively strong.
This may suggest a crooked relationship where an increase in income inequality can lead to a significant increase in gross domestic product per inhabitant, but there may be an upper limit to this increase.

**Significance of Alternative Forms:**

-   Logarithmic forms are considered for Spain and the Netherlands due to weak and negative correlations, capturing potential non-linear relationships.

-   A cubic form is applied to Greece where a positive and relatively strong correlation exists, indicating a more intricate relationship with a potential upper limit.

As wee see at @tbl-nine we have a regression model in logarithmic form for both Spain and the Netherlands:

-   For Spain: **`log_GDP_per_capita = 9.9493 - 0.0022 * log_gini_n2`**
-   For the Netherlands: **`log_GDP_per_capita = 9.8536 - 0.1485 * log_gini_n2`**
-   Both models indicate a negative relationship between income inequality and GDP per capita in Spain and the Netherlands. As income inequality increases, a decrease in GDP per capita is expected.

In @tbl-cubic we have a regression model in cubic form for Greece:

-   Cubic regression model: **`log_GDP_per_capita = 16.2524 + 5.3217 * log_gini_n2 + 1.4039 * I(log_gini_n2^2) + 0.1208 * I(log_gini_n2^3)`**

-   Complex cubic relationship in Greece: The model suggests a positive relationship, indicating that an increase in income inequality may lead to a substantial increase in GDP per capita, but with a potential upper limit.

The analysis reveals nuanced relationships between income inequality and GDP per capita in Spain, the Netherlands, and Greece.
Logarithmic and cubic functional forms offer a better fit for capturing the complexities of these relationships, providing valuable insights for policymakers and organizations to formulate targeted strategies.
Understanding these functional forms is crucial for a more accurate interpretation of the impact of income distribution on economic prosperity in each country.

**Comparison and Summarizing**:

In summary, our in-depth regression analysis explored the dynamics between income inequality and GDP per capita across diverse nations, including Spain, the Netherlands, Greece, Poland, and Slovenia.
The key findings are as follows:

1.  **Original Linear Model: @tbl-four**

    -   Negative correlation observed: Coefficient of -0.023270.

    -   Implies that an increase in GDP per capita tends to reduce income inequality.

2.  **Logarithmic Models (Spain and the Netherlands): @tbl-nine**

    -   Diminishing effect observed: Economic growth has a relatively greater impact on reducing income inequality in low-income economies compared to high-income ones.

3.  **Cubic Model (Greece): @tbl-cubic**

    -   Indicates a more intricate relationship.

    -   Possible critical points or curvatures in the relationship between income inequality and GDP per capita.

**Implications:**

-   Alternative models provide nuanced insights into the economic relationships.

-   Understanding the diminishing effect in logarithmic models and the intricate nature in cubic models is crucial for tailored economic policies.

-   Policymakers should consider the diverse impacts of economic growth on income inequality across different income levels.

### **Heteroskedasticity Testing by** **Breusch Pagan Test**

The Breusch-Pagan test will be applied to investigate heteroskedasticity in our linear regression models.
This test aims to discern whether there is evidence of variable error variance (heteroscedasticity) or consistent error variance (homoscedasticity).
The results will inform the reliability of our regression outcomes, with heteroskedasticity potentially affecting the validity of the analysis.

Reading from @tbl-ten , the original regression model, we see that the statistical Significance (p-value):The p-value of 0.1816 is greater than common significance levels like 0.05.
This suggests that we do not have sufficient evidence to reject the null hypothesis of homoskedasticity.
In other words, there is no statistically significant evidence of heteroskedasticity in the original linear model for all countries based on the Breusch-Pagan test.

Conclusion: Given these results, we cannot conclude that there is heteroskedasticity in the original linear model for all countries.
The model appears to handle the variation in errors uniformly across all observations.

If the p-value had been lower (typically below 0.05), it would have indicated evidence of heteroskedasticity.
In such cases, a more appropriate model might include corrections, such as robust standard errors, to address potential heteroskedasticity.

As wee can read off @tbl-eleven from Spain, the Netherlands and Greece:

Spain: The p-value of 0.6383 is larger than common significance levels (e.g., 0.05), suggesting that there is no significant evidence of heteroskedasticity in the model for Spain.
The model appears to handle the variation in errors effectively, showing homoskedasticity.

The Netherlands: Similar to the case of Spain, the p-value of 0.3173 is greater than conventional significance levels, indicating no significant evidence of heteroskedasticity in the model for the Netherlands.
The model seems to account for error variance consistently across observations.

Greece: For the cubic model in Greece, the p-value of 0.3461 is higher than common significance levels.
This suggests that there is no significant evidence of heteroskedasticity in the cubic model for Greece.
The model handles the variance in errors effectively.

### Causality

Based on the results of the Breusch-Pagan tests for both the original model and the alternative models, it seems that none of the models provide strong evidence of heteroskedasticity.
The p-values are all relatively high, not providing sufficient grounds to reject the null hypothesis of homoskedasticity.

As we can observe, neither the original model nor the alternative models show strong evidence of heteroskedasticity.
There are several strategies one can employ to induce evidence of heteroskedasticity in the models.
To manipulate the error term by adding extreme values for specific observations or by introducing exponential growth can be strategies to generate heteroskedasticity in the models.

Adding Extreme Values: By introducing extreme values to the error term for selected observations, you create variation in the error term that may manifest as heteroskedasticity.
This can be achieved by identifying specific data points that experience a significant increase in the variance of the error term.

Exponential Growth in the Error Term: Introducing exponential growth in the error term as a function of one or more independent variables will also lead to increasing variance.
This can mimic situations where the uncertainty in observations grows exponentially with changes in the independent variables.

**Panel Estimates:**

In the context of fixed-effects panel estimation models in @tbl-twelve, we explored the impact of GDP per capita on regional inequality, incorporating different combinations of fixed effects---Country, Year, NUTS2, and their various combinations.
The coefficient for GDP per capita remained consistently positive and highly statistically significant across all model specifications (\*\*\* p \< 0.01), indicating a robust positive association between GDP per capita and regional inequality.

![](siste.png){fig-align="center" width="329"}

Key descriptive statistics include:

-   The dataset comprises 1232 observations for each fixed effect configuration, ensuring a robust sample size.
-   R-squared values, representing the proportion of variance explained by the models, consistently hover around 0.124, suggesting a moderate level of explanatory power.
-   F-statistics, testing the overall significance of the models, are consistently high at 164.325, emphasizing that the inclusion of fixed effects significantly enhances the model fit.
-   Corresponding p-values for the F-statistics are all extremely low (0.000), providing strong evidence against the null hypothesis of no effect.

In summary, our fixed-effects panel models consistently reveal a positive and highly significant relationship between GDP per capita and regional inequality, regardless of the combination of fixed effects considered.
These models exhibit a reasonable explanatory power, as indicated by the R-squared values, and the inclusion of fixed effects significantly improves the overall model fit, as reflected in the high F-statistics and low p-values.
These findings underscore the meaningful predictive capacity of GDP per capita concerning regional inequality within the framework of our panel dataset.

## Summary and Conclusion

In this comprehensive Eurostat EDA covering countries like Ireland, Poland, Spain, Slovenia, the Netherlands, Greece, Norway, and Albania, our analysis explored the dynamics of sub-national GDP and regional inequality.
Ireland and Norway stood out with high GDP, while Spain exhibited economic disparities.
The regression models unveiled nuanced relationships, with Spain displaying a weak correlation, Poland showing minimal significance, and Greece indicating a significant positive correlation, challenging conventional expectations.
Additional analyzes on new firms, farm areas, and highways as determinants of inequality yielded inconclusive results for Spain and the Netherlands, emphasizing the need for further investigation.
Logarithmic forms revealed negative correlations between GDP per capita and Gini coefficients in Spain and the Netherlands, while heteroskedasticity testing confirmed model robustness.
Causality assessments found no strong evidence of heteroskedasticity, and panel estimates consistently demonstrated a positive and highly significant association between GDP per capita and regional inequality.
This Eurostat EDA underscores the complexity of regional economic disparities, highlighting the importance of tailored policy interventions for effective economic justice.
:)

## **Appendix**

```{r}
#| echo: FALSE
#GDP
GDP <- read_csv("GDP.csv", show_col_types = FALSE)

NO_GDP <- GDP |> 
  filter(str_sub(geo,1,2) == "NO") |> 
  filter(unit == "MIO_EUR")

GDP <- GDP |> 
  select(year = TIME_PERIOD, unit, geo, gdp = OBS_VALUE)
```

```{r}
#| echo: FALSE
#Population
population <- read_csv("population.csv", show_col_types = FALSE)

population <- population |> 
  select(year = TIME_PERIOD, geo, population = OBS_VALUE)
```

```{r}
#| echo: FALSE
#Find unique geo codes in population. Use these to reduce GDP
nuts_pop <- population |> 
  select(geo) |> 
  distinct() |> 
  pull()

nuts_gdp <- GDP |> 
  select(geo) |> 
  distinct() |> 
  pull()
```

```{r}
#| echo: FALSE
nuts_inpop_notinGDP <- setdiff(nuts_pop, nuts_gdp)

GDP <- GDP |>
  filter(geo %in% nuts_pop) |> 
  filter(unit == "MIO_EUR") |> 
  select(-unit)
```

```{r}
#| echo: FALSE
merged_data <- left_join(population, GDP, join_by(year, geo)) |> 
    filter(!geo %in% nuts_inpop_notinGDP)

NO_merged <- merged_data |> 
  filter(str_sub(geo,1,2) == "NO") 

merged_data <- merged_data |> 
  mutate(
    GDP_per_capita = round(1000000*gdp/population, digits = 0)
  ) |> 
  rename(gdp_MIO = gdp)
```

```{r}
#| echo: FALSE
result <- merged_data |> 
  mutate(
    geo_2 = str_sub(geo, start = 1L, end = 2L)
  ) |> 
  filter(geo_2 %in% c("ES", "NO", "IE", "PL", 
                      "NL", "AL", "EL", "SI")
         ) |> 
# removes data for obs that have no values
# for GDP since 2008
  filter(!is.na(GDP_per_capita)) |> 
  group_by(geo_2) |> 
  summarize(
    Mean = mean(GDP_per_capita),
    Variance = var(GDP_per_capita),
    Max = max(GDP_per_capita),
    Min = min(GDP_per_capita)
  )
```

```{r}
#| echo: FALSE
#| label: tbl-one
#| tbl-cap: "Summarize GDP" 
result |> 
  knitr::kable()
```

```{r}
#| echo: FALSE
merged_data_temp <- merged_data %>%
  mutate(id_nuts3 = geo, 
         id_nuts2 = substr(geo, 1, 4),
         id_nuts0 = substr(geo, 1, 2)) 

merged_data_temp %<>% 
  filter(population != "NA") %>%
filter(population != 0) %>%
  filter(GDP_per_capita != "NA") %>%
  group_by(id_nuts2, year) %>%
  mutate(gini_n2 = gini.wtd(GDP_per_capita, weights = population)) %>%
  ungroup()

main_data_nuts2 <- merged_data_temp %>%
  group_by(id_nuts2, year) %>%
  arrange(id_nuts2, year) %>%
  filter(row_number() == 1)
```

```{r}
#| echo: FALSE
#| label: fig-one
#| fig-cap: "Scatter plot of Gini Koefficients over time" 
#make a plot with all nuts2 values to get an overview
ggplot(main_data_nuts2, aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_point() +
  labs(title = "Scatter Plot of Gini-koeffisienter over time",
       x = "Year",
       y = "Gini-koeffisient") +
  theme_minimal()
```

```{r}
#| echo: FALSE
#| label: fig-two
#| fig-cap: "Scatter plot of Gini Koefficients for some countries" 
main_data_nuts2 |> 
  filter(id_nuts0 == "PL" | 
           id_nuts0 == "ES") |> 
  ggplot(aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_line() +
  labs(title = "Scatter Plot av Gini-koeffisienter over tid",
       x = "År",
       y = "Gini-koeffisient") +
  theme_minimal()
```

```{r}
#| echo: FALSE
# remove Norway as we were not going to use it further in the assignment as mentioned earlier
main_data2 <- main_data_nuts2 |> 
  filter(!grepl("NO", id_nuts2))
```

```{r}
#| echo: FALSE
# Filter the dataset for the year 2010
data_2010 <- main_data2 %>%
  filter(year == 2010)

# List of country codes
country_codes <- c("ES", "PL", "NL", "SI", "EL")

# Create an empty list to store regression models
regression_models <- list()

for (country_code in country_codes) {
  # Filter the dataset for each country and check for data availability
  data <- data_2010 %>%
    filter(id_nuts0 == country_code)
  
  if (nrow(data) > 0) {
    # Perform regression directly within the loop
    regression_model <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data)
    
    # Add the model to the list
    regression_models[[country_code]] <- regression_model
    
  } else {
    cat("No data found for", country_code, "in 2010\n")
  }
}
```

```{r}
#| echo: FALSE
# Perform regression on the combined dataset
regression_model_all_countries <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data_2010)
```

```{r}
#| echo: FALSE
#| label: tbl-four
#| tbl-cap: "original linear model"
# Display regression results using huxreg
huxreg(regression_model_all_countries, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#| label: tbl-five
#| tbl-cap: "Linear regression each country" 
huxreg(regression_models$ES, regression_models$PL, regression_models$NL, regression_models$SI, regression_models$EL, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#Remove rows with missing values
test <- data_2010[complete.cases(data_2010),]
# Filter the dataset for only Spain (ES) and Netherlands (NL) and Greece (EL)
subset_data <- subset(test, id_nuts0 %in% c("ES", "NL", "EL"))
# Filter the dataset for only Spain (ES)
subset_data_es <- subset_data[subset_data$id_nuts0 == "ES", ]
```

```{r}
#| echo: FALSE
#| label: fig-es
#| fig-cap: "Scatter Plot for Spain (ES): Regional Development vs. Regional Inequality"
# Create a scatterplot with a regression line for Spain (ES)
ggplot(subset_data_es, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +

  labs(
    title = "Scatter Plot for Spain (ES): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

```{r}
#| echo: FALSE
subset_data_nl <- subset_data[subset_data$id_nuts0 == "NL", ]
```

```{r}
#| echo: FALSE
#| label: fig-nl
#| fig-cap: "Scatter Plot for Netherlands (NL): Regional Development vs. Regional Inequality"
# Filter the dataset for only Netherlands (NL)
# Create a scatterplot with a regression line for Netherlands (NL)
ggplot(subset_data_nl, aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +
  labs(
    title = "Scatter Plot for Netherlands (NL): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

```{r}
#| echo: FALSE
subset_data_el <- subset_data[subset_data$id_nuts0 == "EL", ]
```

```{r}
#| echo: FALSE
#| label: fig-el
#| fig-cap: "Scatter Plot for Greece (EL): Regional Development vs. Regional Inequality"
subset_data |> 
  filter(id_nuts0 == "EL") |> 
  ggplot(aes(x = gini_n2, y = GDP_per_capita)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, color = "yellow", fill = "transparent") +
  labs(
    title = "Scatter Plot for Greece (EL): Regional Development vs. Regional Inequality",
    x = "Regional Development",
    y = "Regional Inequality"
  ) +
  theme_minimal()
```

```{r}
#| echo: FALSE
#making a new dataset only for Spain, Netherlands and Greece for 2010
SN2010 <- data_2010 |> 
  filter(id_nuts0 %in% c("ES", "NL", "EL"))

#| echo: FALSE
highway <- read_csv("motorvei2.csv", show_col_types = FALSE)
innovation <- read_csv("innovation.csv", show_col_types = FALSE)
farm <- read_csv("farm1.csv", show_col_types = FALSE)
```

```{r}
#| echo: FALSE
#we rename one of the variables and select the ones we want
highway <- highway |> 
  select(KM = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
farm <- farm |> 
  select(Area = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
innovation <- innovation |> 
  select(newfirms = OBS_VALUE, id_nuts2 = geo, year = TIME_PERIOD)
```

```{r}
#| echo: FALSE
#A small comment on the dataset "innovation" is that it is data from 2013 and not 2010. So we mutate it to 2010. 
innovation <- innovation |> 
  mutate(year = 2010)

#we merge the dataset SN2010 and innovation together
merged_innovation <- left_join(SN2010, innovation, join_by(year, id_nuts2))
```

```{r}
#| echo: FALSE
#| label: tbl-six
#| tbl-cap: "regression models for Spain, the Netherlands - innovation"
# Create a list of regression models for Spain, the Netherlands
regression_models_2countries <- list()

# Filter the dataset for each country and check for data availability
data_es <-  merged_innovation %>% filter(id_nuts0 == "ES")
data_nl <- merged_innovation %>% filter(id_nuts0 == "NL")

# Perform regression for Spain
regression_model_es <- lm(gini_n2 ~ newfirms, data = data_es)
regression_models_2countries$ES <- regression_model_es

# Perform regression for the Netherlands
regression_model_nl <- lm(gini_n2 ~ newfirms, data = data_nl)
regression_models_2countries$NL <- regression_model_nl

huxreg(regression_models_2countries$ES,regression_models_2countries$NL,
statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#| label: tbl-innovationandpop
#| tbl-cap: "regression models for Spain,Netherlands innovation and population"
# Making a regression model with the variables gini_n2, newfirms, and population
regression_innovationp_es <- lm(gini_n2 ~ I(newfirms/10000) + I(population/1000000), data = merged_innovation %>% filter(id_nuts0 == "ES"))
regression_innovationp_nl <- lm(gini_n2 ~ I(newfirms/10000) + I(population/1000000), data = merged_innovation %>% filter(id_nuts0 == "NL"))

huxreg(regression_innovationp_es, regression_innovationp_nl, statistics =  c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
merged_farm <- left_join(SN2010, farm, join_by(year, id_nuts2))
```

```{r}
#| echo: FALSE
#| label: tbl-seven
#| tbl-cap: "regression models for Spain,Netherlands and greece - farm"
regression_farm_es <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "ES"))
regression_farm_nl <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "NL"))
regression_farm_el <- lm(gini_n2 ~ I(Area/100000), data = merged_farm %>% filter(id_nuts0 == "EL"))
huxreg(regression_farm_es, regression_farm_nl, regression_farm_el, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#| label: tbl-eight
#| tbl-cap: "regression models for Spain and the Netherlands  - highway"

merged_highway <- left_join(merged_farm, highway, join_by(year, id_nuts2))

regression_highway_es <- lm(gini_n2 ~ I(KM/100000), data = merged_highway %>% filter(id_nuts0 == "ES"))
regression_highway_nl <- lm(gini_n2 ~ I(KM/100000), data = merged_highway %>% filter(id_nuts0 == "NL"))
huxreg(regression_highway_es, regression_highway_nl, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#Making a correlation matrices for Spania
cor_matrix_spain <- cor(subset_data_es[, c("gini_n2", "GDP_per_capita")])

# Making a correlation matrices for Nederland
cor_matrix_netherlands <- cor(subset_data_nl[, c("gini_n2", "GDP_per_capita")])

#Making a correlation matrices for Hellas
cor_matrix_greece <- cor(subset_data_el[, c("gini_n2", "GDP_per_capita")])
```

```{r}
#| echo: FALSE
#| label: tbl-corr
#| tbl-cap: "correlation matrices"
print("Correlation matrices for Spania")
print(cor_matrix_spain)

print("Correlation matrices for the Netherlands")
print(cor_matrix_netherlands)

print("Correlation matrices for Greece")
print(cor_matrix_greece)
```

```{r}
#| echo: FALSE
# Convert the data to the logarithm for Spain
subset_data_es$log_gini_n2 <- log(subset_data_es$gini_n2)
subset_data_es$log_GDP_per_capita <- log(subset_data_es$GDP_per_capita)

# Convert the data to the logarithm for the Netherlands
subset_data_nl$log_gini_n2 <- log(subset_data_nl$gini_n2)
subset_data_nl$log_GDP_per_capita <- log(subset_data_nl$GDP_per_capita)
```

```{r}
#| echo: FALSE
# Remove "-Inf" values from log_gini_n2 for Spain
subset_data_es <- subset_data_es[!is.infinite(subset_data_es$log_gini_n2), ]

# Remove "-Inf" values from log_gini_n2 for the Netherlands
subset_data_nl <- subset_data_nl[!is.infinite(subset_data_nl$log_gini_n2), ]
```

```{r}
#| echo: FALSE
# Fit linear regression for Spain
lm_model_spain <- lm(log_GDP_per_capita ~ log_gini_n2, data = subset_data_es)

# Fit linear regression for the Netherlands
lm_model_netherlands <- lm(log_GDP_per_capita ~ log_gini_n2, data = subset_data_nl)
```

```{r}
#| echo: FALSE
#| label: tbl-nine
#| tbl-cap: "LM model for Spain and the Netherlands"
print("LM for Spania")
print(lm_model_spain)

print("LM for the Netherlands")
print(lm_model_netherlands)
```

```{r}
#| echo: FALSE
# Regression coefficients for Spain
a_spain <- coef(lm_model_spain)["log_gini_n2"]
b_spain <- coef(lm_model_spain)["(Intercept)"]

# Regression coefficients for the Netherlands
a_netherlands <- coef(lm_model_netherlands)["log_gini_n2"]
b_netherlands <- coef(lm_model_netherlands)["(Intercept)"]
```

```{r}
#| echo: FALSE
# Print regression coefficients for Spain
print("Regresjonskoeffisienter for Spani")
print(paste("a_spain:", a_spain))
print(paste("b_spain:", b_spain))

# Print regression coefficients for the Netherlands
print("Regresjonskoeffisienter for Nederland")
print(paste("a_netherlands:", a_netherlands))
print(paste("b_netherlands:", b_netherlands))
```

```{r}
#| echo: FALSE
# Create logarithmically transformed columns for Greece
subset_data_el$log_gini_n2 <- log(subset_data_el$gini_n2)
subset_data_el$log_GDP_per_capita <- log(subset_data_el$GDP_per_capita)
```

```{r}
#| echo: FALSE
# Fit cubic regression for Greece
lm_model_greece_cubic <- lm(log_GDP_per_capita ~ log_gini_n2 + I(log_gini_n2^2) + I(log_gini_n2^3), data = subset_data_el)
```

```{r}
#| echo: FALSE
#| label: tbl-Cubic
#| tbl-cap: "Cubic regression for greece"
print(lm_model_greece_cubic)
```

```{r}
#| echo: FALSE
# Regression coefficients for Greece (cubic)
coefficients_greece_cubic <- coef(lm_model_greece_cubic)

# Display the coefficients for the cubic regression
coefficients_greece_cubic
```

```{r}
#| echo: FALSE
# Perform regression on the combined dataset
regression_model_all_countries <- lm(gini_n2 ~ I(GDP_per_capita/10000), data = data_2010)

# Display regression results using huxreg
huxreg(regression_model_all_countries, statistics = c(N = "nobs", R2 = "r.squared", adjustedR = "adj.r.squared", p.value = "p.value"))
```

```{r}
#| echo: FALSE
#Getting the residual from models
residuals_original <- resid(regression_model_all_countries)

#Performing the Breusch-Pagan test
hetero_test_original <- bptest(regression_model_all_countries)
```

```{r}
#| echo: FALSE
#| label: tbl-ten
#| tbl-cap: "Hetroskedasticity test for the original model"
print(hetero_test_original)
```

```{r}
#| echo: FALSE
#Getting the residuals from the alternative model
residuals_alternative_S <- resid(lm_model_spain)

#Performing the Breusch-Pagan test
hetero_test_spain <- bptest(lm_model_spain)

#Getting the residuals from the alternative model
residuals_alternative_N <- resid(lm_model_netherlands)

#Performing the Breusch-Pagan test
hetero_test_netherlands <- bptest(lm_model_netherlands)

#Getting the residuals from the alternative model
residuals_alternative_G <- resid(lm_model_greece_cubic)

#Performing the Breusch-Pagan test
hetero_test_greece <- bptest(lm_model_greece_cubic)
```

```{r}
#| echo: FALSE
#| label: tbl-eleven
#| tbl-cap: "Hetroskedasticity test for Spain, Nederlands and Greece"
print(hetero_test_spain)
print(hetero_test_netherlands)
print(hetero_test_greece)
```

```{r}
#| echo: FALSE
# Corrected dataset
Panel_Data <- main_data2 %>%
  distinct(year, geo, id_nuts0, id_nuts2, GDP_per_capita, population, gini_n2) %>%
  mutate(GDP_per_capita = GDP_per_capita) %>%
  mutate(gini_nuts3 = gini_n2 * 100000) %>%
  select(year, geo, id_nuts0, id_nuts2, population, GDP_per_capita, gini_n2, gini_nuts3) %>%
  pdata.frame(index = c("id_nuts2","year"))
```

```{r}
#| echo: FALSE
# Model 1: Estimate the effect at Geo level with several indices
plm1 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("year", "id_nuts2"), model = "within") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)

# Model 2: Estimate the effect at Year level
plm2 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("year"), model = "within", effect = "individual") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)

# Model 3: Estimate the effect at NUTS2 level
plm3 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("id_nuts0"), model = "within") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)

# Modell 4: Estimer effekten på kombinert Geo, Year, NUTS2-nivå
plm4 <- plm(gini_nuts3 ~ GDP_per_capita, data = Panel_Data, index = c("geo", "year", "id_nuts0"), model = "within", effect = "twoways") %>% 
  coeftest(vcov. = vcovHC, type = "HC1", save = TRUE)
```

```{r}
#| echo: FALSE
#| label: tbl-twelve
#| tbl-cap: "Panel estimation"

huxreg(
  list(
    "Fixed effect Country" = plm1,
    "Fixed effect Year" = plm2,
    "Fixed effect NUTS2" = plm3,
    "Fixed effect NUTS2,year" = plm4
  ),
  statistics = c(N = "nobs", R2 = "r.squared", FStat = "statistic", PValue = "p.value"),
  stars = c("*" = 0.1, "**" = 0.05, "***" = 0.01),
  note = "Note): {stars} T statistics in brackets."
)
```

\clearpage

## References

::: {#refs}
:::
